{"ast":null,"code":"import React,{useState,useContext,useEffect,useRef}from'react';import{X,Plus,Minus,Loader,Pizza,Check,ShoppingCart,ChevronRight,ChevronLeft,Package}from'lucide-react';import{CartContext}from'../../context/CartContext';import woocommerceApi from'../../services/woocommerceApi';import escandalososApi from'../../services/escandalososApi';import'./ComboModal.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const ComboModal=_ref=>{let{product,isOpen,onClose}=_ref;const{addToCart}=useContext(CartContext);const modalRef=useRef(null);// Estados principales\nconst[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[comboConfig,setComboConfig]=useState(null);const[availableProducts,setAvailableProducts]=useState({});const[selectedProducts,setSelectedProducts]=useState({});const[quantity,setQuantity]=useState(1);const[addingToCart,setAddingToCart]=useState(false);const[currentStep,setCurrentStep]=useState(0);const[animationClass,setAnimationClass]=useState('');// Reset estados cuando se abre el modal\nuseEffect(()=>{if(isOpen&&product){resetForm();loadComboData();// Prevenir scroll del body\ndocument.body.style.overflow='hidden';}else{document.body.style.overflow='';}return()=>{document.body.style.overflow='';};},[isOpen,product]);// Manejo de teclas (ESC para cerrar)\nuseEffect(()=>{const handleEsc=e=>{if(e.key==='Escape'&&isOpen){onClose();}};window.addEventListener('keydown',handleEsc);return()=>window.removeEventListener('keydown',handleEsc);},[isOpen,onClose]);const resetForm=()=>{setSelectedProducts({});setQuantity(1);setError(null);setCurrentStep(0);setAnimationClass('');};const loadComboData=async()=>{setLoading(true);setError(null);try{// Obtener configuración del plugin Escandalosos\nconst escandalososConfig=await escandalososApi.getConfig();// Verificar si el producto es un combo\nconst productConfig=escandalososConfig.products[product.id];if(!productConfig||!productConfig.is_combo){throw new Error('Este producto no está configurado como combo');}setComboConfig(productConfig.combo_config);// Cargar productos para cada categoría del combo\nconst productsToLoad={};for(const[categoryId,config]of Object.entries(productConfig.combo_config)){try{// Obtener productos de la categoría\nconst categoryProducts=await woocommerceApi.getProducts({category:categoryId,status:'publish',per_page:100});productsToLoad[categoryId]=categoryProducts.filter(p=>p.id!==product.id&&// Excluir el combo actual\np.status==='publish'&&p.catalog_visibility!=='hidden');}catch(err){console.error(`Error cargando productos de categoría ${categoryId}:`,err);productsToLoad[categoryId]=[];}}setAvailableProducts(productsToLoad);initializeSelections(productConfig.combo_config);}catch(error){console.error('Error cargando datos del combo:',error);setError('Error al cargar las opciones del combo. Por favor, intenta nuevamente.');}finally{setLoading(false);}};const initializeSelections=comboConfig=>{const initialSelections={};Object.entries(comboConfig).forEach(_ref2=>{let[categoryId,config]=_ref2;initialSelections[categoryId]=[];});setSelectedProducts(initialSelections);};const handleProductToggle=(categoryId,productId)=>{const category=comboConfig[categoryId];const currentSelections=selectedProducts[categoryId]||[];if(currentSelections.includes(productId)){// Deseleccionar el producto\nsetSelectedProducts(prev=>({...prev,[categoryId]:currentSelections.filter(id=>id!==productId)}));}else{// Seleccionar el producto\nif(category.maxSelection===1){// Si solo se permite una selección, reemplazar\nsetSelectedProducts(prev=>({...prev,[categoryId]:[productId]}));}else{// Para múltiples selecciones\nif(currentSelections.length<category.maxSelection){setSelectedProducts(prev=>({...prev,[categoryId]:[...currentSelections,productId]}));}}}};const isStepComplete=categoryId=>{const category=comboConfig[categoryId];const selections=selectedProducts[categoryId]||[];return selections.length>=category.minSelection;};const canProceed=()=>{const categoryIds=Object.keys(comboConfig);// Si estamos en el último paso de categorías, verificar si podemos ir al resumen\nif(currentStep===categoryIds.length-1){const currentCategoryId=categoryIds[currentStep];return isStepComplete(currentCategoryId)&&canAddToCart();}// Para otros pasos, solo verificar si el paso actual está completo\nif(currentStep<categoryIds.length){const currentCategoryId=categoryIds[currentStep];return isStepComplete(currentCategoryId);}return false;};const canAddToCart=()=>{return Object.entries(comboConfig).every(_ref3=>{let[categoryId,config]=_ref3;const selections=selectedProducts[categoryId]||[];return selections.length>=config.minSelection;});};const handleNextStep=()=>{const categoryIds=Object.keys(comboConfig);if(currentStep<categoryIds.length-1){// Avanzar al siguiente paso de categoría\nsetAnimationClass('fade-exit-active');setTimeout(()=>{setCurrentStep(currentStep+1);setAnimationClass('fade-enter-active');},200);}else if(currentStep===categoryIds.length-1){// Ir al paso final de resumen\nsetAnimationClass('fade-exit-active');setTimeout(()=>{setCurrentStep(categoryIds.length);setAnimationClass('fade-enter-active');},200);}};const handlePreviousStep=()=>{if(currentStep>0){setAnimationClass('fade-exit-active');setTimeout(()=>{setCurrentStep(currentStep-1);setAnimationClass('fade-enter-active');},200);}};const handleStepClick=index=>{if(index<=currentStep||index>0&&isStepComplete(Object.keys(comboConfig)[index-1])){setAnimationClass('fade-exit-active');setTimeout(()=>{setCurrentStep(index);setAnimationClass('fade-enter-active');},200);}};const calculateTotalPrice=()=>{const basePrice=parseFloat(product.price)||0;return basePrice*quantity;};const formatPrice=price=>{return new Intl.NumberFormat('es-CL',{style:'currency',currency:'CLP',minimumFractionDigits:0,maximumFractionDigits:0}).format(price);};const handleAddToCart=async()=>{if(!canAddToCart())return;setAddingToCart(true);try{var _product$images,_product$images$,_modalRef$current;// Preparar información del combo\nconst comboInfo={selections:{}};// Mapear productos seleccionados con sus nombres\nfor(const[categoryId,productIds]of Object.entries(selectedProducts)){const categoryProducts=availableProducts[categoryId]||[];comboInfo.selections[categoryId]=productIds.map(id=>{const product=categoryProducts.find(p=>p.id===id);return{id,name:(product===null||product===void 0?void 0:product.name)||'Producto'};});}// Crear el item del carrito con la estructura esperada por CheckoutPage\nconst cartItem={// Usar un ID único para el item del carrito\nid:`${product.id}-combo-${Date.now()}`,// IMPORTANTE: Agregar productId que es lo que espera CheckoutPage\nproductId:product.id,// Mantener el resto de la información\nname:product.name,price:parseFloat(product.price),quantity:quantity,image:((_product$images=product.images)===null||_product$images===void 0?void 0:(_product$images$=_product$images[0])===null||_product$images$===void 0?void 0:_product$images$.src)||null,// Agregar customizations en el formato esperado\ncustomizations:{type:'combo',comboSelections:comboInfo.selections,comboConfig:comboConfig,// Agregar información adicional para el pedido\nspecialInstructions:'',// Por si se necesita después\nproductAddons:[]// Por compatibilidad con el checkout\n}};// Agregar al carrito\nawait addToCart(cartItem);// Cerrar modal con animación\n(_modalRef$current=modalRef.current)===null||_modalRef$current===void 0?void 0:_modalRef$current.classList.add('closing');setTimeout(()=>{onClose();},300);}catch(error){console.error('Error al agregar al carrito:',error);setError('Error al agregar el combo al carrito');}finally{setAddingToCart(false);}};const renderProgressSteps=()=>{if(!comboConfig)return null;const categoryIds=Object.keys(comboConfig);const isLastStep=currentStep>=categoryIds.length;if(isLastStep)return null;// No mostrar en el paso final\nreturn/*#__PURE__*/_jsx(\"div\",{className:\"progress-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"progress-steps\",children:categoryIds.map((categoryId,index)=>{const category=comboConfig[categoryId];const isActive=index===currentStep;const isCompleted=isStepComplete(categoryId)&&index<currentStep;const isClickable=index<=currentStep||index>0&&isStepComplete(categoryIds[index-1]);return/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:`progress-step ${isActive?'active':''} ${isCompleted?'completed':''}`,onClick:()=>isClickable&&handleStepClick(index),style:{cursor:isClickable?'pointer':'default'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"step-indicator\",children:isCompleted?/*#__PURE__*/_jsx(Check,{size:20}):index+1}),/*#__PURE__*/_jsx(\"span\",{className:\"step-label\",children:category.name})]}),index<categoryIds.length-1&&/*#__PURE__*/_jsx(\"div\",{className:`step-connector ${isCompleted?'completed':''}`})]},categoryId);})})});};const renderCategoryProducts=()=>{if(!comboConfig)return null;const categoryIds=Object.keys(comboConfig);// Verificar que no estamos en el paso final\nif(currentStep>=categoryIds.length)return null;const currentCategoryId=categoryIds[currentStep];const currentCategory=comboConfig[currentCategoryId];const products=availableProducts[currentCategoryId]||[];const selections=selectedProducts[currentCategoryId]||[];return/*#__PURE__*/_jsxs(\"div\",{className:`category-section ${animationClass}`,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"category-header\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"category-title\",children:currentCategory.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"category-description\",children:[\"Selecciona \",currentCategory.minSelection===currentCategory.maxSelection?currentCategory.minSelection:`entre ${currentCategory.minSelection} y ${currentCategory.maxSelection}`,currentCategory.minSelection===1?' opción':' opciones']}),selections.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"selection-indicator\",children:[/*#__PURE__*/_jsx(Check,{size:16}),selections.length,\" de \",currentCategory.maxSelection,\" seleccionado\",selections.length!==1?'s':'']})]}),/*#__PURE__*/_jsx(\"div\",{className:\"products-grid\",children:products.map(prod=>{const isSelected=selections.includes(prod.id);const isDisabled=!isSelected&&selections.length>=currentCategory.maxSelection;return/*#__PURE__*/_jsxs(\"div\",{className:`product-card ${isSelected?'selected':''} ${isDisabled?'disabled':''}`,onClick:()=>!isDisabled&&handleProductToggle(currentCategoryId,prod.id),tabIndex:0,role:\"button\",\"aria-pressed\":isSelected,onKeyPress:e=>{if((e.key==='Enter'||e.key===' ')&&!isDisabled){handleProductToggle(currentCategoryId,prod.id);}},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"product-image-container\",children:[prod.images&&prod.images[0]?/*#__PURE__*/_jsx(\"img\",{src:prod.images[0].src,alt:prod.name,className:\"product-image\",loading:\"lazy\"}):/*#__PURE__*/_jsx(\"div\",{className:\"product-image-placeholder\",children:/*#__PURE__*/_jsx(Pizza,{size:40})}),/*#__PURE__*/_jsx(\"div\",{className:\"selection-badge\",children:/*#__PURE__*/_jsx(Check,{size:20})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-info\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"product-name\",children:prod.name}),/*#__PURE__*/_jsx(\"p\",{className:\"product-description\",dangerouslySetInnerHTML:{__html:prod.short_description||prod.description||''}})]})]},prod.id);})}),products.length===0&&/*#__PURE__*/_jsxs(\"div\",{className:\"state-container\",children:[/*#__PURE__*/_jsx(Package,{size:64,color:\"var(--text-light)\"}),/*#__PURE__*/_jsx(\"p\",{className:\"state-message\",children:\"No hay productos disponibles en esta categor\\xEDa\"})]})]});};const renderFinalStep=()=>{return/*#__PURE__*/_jsxs(\"div\",{className:\"summary-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"summary-header\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"summary-title\",children:\"\\xA1Tu combo est\\xE1 listo!\"}),/*#__PURE__*/_jsx(\"p\",{className:\"summary-price\",children:formatPrice(product.price)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"selections-summary\",children:Object.entries(selectedProducts).map(_ref4=>{let[categoryId,productIds]=_ref4;const category=comboConfig[categoryId];const categoryProducts=availableProducts[categoryId]||[];if(productIds.length===0)return null;return/*#__PURE__*/_jsxs(\"div\",{className:\"selection-category\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"selection-category-name\",children:category.name}),/*#__PURE__*/_jsx(\"div\",{className:\"selected-items\",children:productIds.map(id=>{const product=categoryProducts.find(p=>p.id===id);return/*#__PURE__*/_jsx(\"span\",{className:\"selected-item-tag\",children:(product===null||product===void 0?void 0:product.name)||'Producto'},id);})})]},categoryId);})}),/*#__PURE__*/_jsxs(\"div\",{className:\"quantity-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"quantity-control\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"quantity-label\",children:\"Cantidad\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"quantity-selector\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"quantity-button\",onClick:()=>setQuantity(Math.max(1,quantity-1)),disabled:quantity<=1,\"aria-label\":\"Disminuir cantidad\",children:/*#__PURE__*/_jsx(Minus,{size:20})}),/*#__PURE__*/_jsx(\"span\",{className:\"quantity-display\",children:quantity}),/*#__PURE__*/_jsx(\"button\",{className:\"quantity-button\",onClick:()=>setQuantity(quantity+1),\"aria-label\":\"Aumentar cantidad\",children:/*#__PURE__*/_jsx(Plus,{size:20})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"total-section\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"total-label\",children:\"Total\"}),/*#__PURE__*/_jsx(\"p\",{className:\"total-amount\",children:formatPrice(calculateTotalPrice())})]})]})]});};if(!isOpen)return null;const categoryIds=Object.keys(comboConfig||{});const isLastStep=currentStep>=categoryIds.length;const isOnCategoryStep=currentStep<categoryIds.length;return/*#__PURE__*/_jsx(\"div\",{className:\"combo-modal-overlay\",onClick:onClose,children:/*#__PURE__*/_jsxs(\"div\",{ref:modalRef,className:\"combo-modal\",onClick:e=>e.stopPropagation(),role:\"dialog\",\"aria-modal\":\"true\",\"aria-labelledby\":\"combo-modal-title\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"modal-handle\"}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:onClose,\"aria-label\":\"Cerrar modal\",children:/*#__PURE__*/_jsx(X,{size:24})}),/*#__PURE__*/_jsxs(\"div\",{className:\"combo-header\",children:[/*#__PURE__*/_jsx(\"h2\",{id:\"combo-modal-title\",className:\"combo-title\",children:isLastStep?'Confirma tu pedido':'Arma tu combo perfecto'}),/*#__PURE__*/_jsx(\"p\",{className:\"combo-subtitle\",children:isLastStep?'Revisa tu selección y agrega al carrito':`Personaliza tu ${(product===null||product===void 0?void 0:product.name)||'combo'} paso a paso`})]}),renderProgressSteps(),loading?/*#__PURE__*/_jsxs(\"div\",{className:\"state-container\",children:[/*#__PURE__*/_jsx(Loader,{className:\"loading-spinner\",size:48}),/*#__PURE__*/_jsx(\"p\",{className:\"state-message\",children:\"Cargando opciones del combo...\"})]}):error?/*#__PURE__*/_jsxs(\"div\",{className:\"state-container\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsx(\"button\",{onClick:loadComboData,className:\"retry-button\",children:\"Reintentar\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"combo-content\",children:isOnCategoryStep?renderCategoryProducts():renderFinalStep()}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-footer\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"nav-button secondary\",onClick:handlePreviousStep,disabled:currentStep===0,children:[/*#__PURE__*/_jsx(ChevronLeft,{size:20}),/*#__PURE__*/_jsx(\"span\",{children:\"Anterior\"})]}),isOnCategoryStep?/*#__PURE__*/_jsxs(\"button\",{className:\"nav-button primary\",onClick:handleNextStep,disabled:!canProceed(),children:[/*#__PURE__*/_jsx(\"span\",{children:\"Siguiente\"}),/*#__PURE__*/_jsx(ChevronRight,{size:20})]}):/*#__PURE__*/_jsx(\"button\",{className:\"add-to-cart-button\",onClick:handleAddToCart,disabled:addingToCart||!canAddToCart(),children:addingToCart?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Loader,{className:\"loading-spinner\",size:20}),/*#__PURE__*/_jsx(\"span\",{children:\"Agregando...\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ShoppingCart,{size:20}),/*#__PURE__*/_jsx(\"span\",{children:\"Agregar al Carrito\"})]})})]})]})]})});};export default ComboModal;","map":{"version":3,"names":["React","useState","useContext","useEffect","useRef","X","Plus","Minus","Loader","Pizza","Check","ShoppingCart","ChevronRight","ChevronLeft","Package","CartContext","woocommerceApi","escandalososApi","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ComboModal","_ref","product","isOpen","onClose","addToCart","modalRef","loading","setLoading","error","setError","comboConfig","setComboConfig","availableProducts","setAvailableProducts","selectedProducts","setSelectedProducts","quantity","setQuantity","addingToCart","setAddingToCart","currentStep","setCurrentStep","animationClass","setAnimationClass","resetForm","loadComboData","document","body","style","overflow","handleEsc","e","key","window","addEventListener","removeEventListener","escandalososConfig","getConfig","productConfig","products","id","is_combo","Error","combo_config","productsToLoad","categoryId","config","Object","entries","categoryProducts","getProducts","category","status","per_page","filter","p","catalog_visibility","err","console","initializeSelections","initialSelections","forEach","_ref2","handleProductToggle","productId","currentSelections","includes","prev","maxSelection","length","isStepComplete","selections","minSelection","canProceed","categoryIds","keys","currentCategoryId","canAddToCart","every","_ref3","handleNextStep","setTimeout","handlePreviousStep","handleStepClick","index","calculateTotalPrice","basePrice","parseFloat","price","formatPrice","Intl","NumberFormat","currency","minimumFractionDigits","maximumFractionDigits","format","handleAddToCart","_product$images","_product$images$","_modalRef$current","comboInfo","productIds","map","find","name","cartItem","Date","now","image","images","src","customizations","type","comboSelections","specialInstructions","productAddons","current","classList","add","renderProgressSteps","isLastStep","className","children","isActive","isCompleted","isClickable","onClick","cursor","size","renderCategoryProducts","currentCategory","prod","isSelected","isDisabled","tabIndex","role","onKeyPress","alt","dangerouslySetInnerHTML","__html","short_description","description","color","renderFinalStep","_ref4","Math","max","disabled","isOnCategoryStep","ref","stopPropagation"],"sources":["/Users/franciscalabra/Desktop/escandalosos/src/components/ComboModal/ComboModal.jsx"],"sourcesContent":["import React, { useState, useContext, useEffect, useRef } from 'react';\nimport { X, Plus, Minus, Loader, Pizza, Check, ShoppingCart, ChevronRight, ChevronLeft, Package } from 'lucide-react';\nimport { CartContext } from '../../context/CartContext';\nimport woocommerceApi from '../../services/woocommerceApi';\nimport escandalososApi from '../../services/escandalososApi';\nimport './ComboModal.css';\n\nconst ComboModal = ({ product, isOpen, onClose }) => {\n  const { addToCart } = useContext(CartContext);\n  const modalRef = useRef(null);\n  \n  // Estados principales\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [comboConfig, setComboConfig] = useState(null);\n  const [availableProducts, setAvailableProducts] = useState({});\n  const [selectedProducts, setSelectedProducts] = useState({});\n  const [quantity, setQuantity] = useState(1);\n  const [addingToCart, setAddingToCart] = useState(false);\n  const [currentStep, setCurrentStep] = useState(0);\n  const [animationClass, setAnimationClass] = useState('');\n\n  // Reset estados cuando se abre el modal\n  useEffect(() => {\n    if (isOpen && product) {\n      resetForm();\n      loadComboData();\n      // Prevenir scroll del body\n      document.body.style.overflow = 'hidden';\n    } else {\n      document.body.style.overflow = '';\n    }\n    \n    return () => {\n      document.body.style.overflow = '';\n    };\n  }, [isOpen, product]);\n\n  // Manejo de teclas (ESC para cerrar)\n  useEffect(() => {\n    const handleEsc = (e) => {\n      if (e.key === 'Escape' && isOpen) {\n        onClose();\n      }\n    };\n    \n    window.addEventListener('keydown', handleEsc);\n    return () => window.removeEventListener('keydown', handleEsc);\n  }, [isOpen, onClose]);\n\n  const resetForm = () => {\n    setSelectedProducts({});\n    setQuantity(1);\n    setError(null);\n    setCurrentStep(0);\n    setAnimationClass('');\n  };\n\n  const loadComboData = async () => {\n    setLoading(true);\n    setError(null);\n    \n    try {\n      // Obtener configuración del plugin Escandalosos\n      const escandalososConfig = await escandalososApi.getConfig();\n      \n      // Verificar si el producto es un combo\n      const productConfig = escandalososConfig.products[product.id];\n      if (!productConfig || !productConfig.is_combo) {\n        throw new Error('Este producto no está configurado como combo');\n      }\n      \n      setComboConfig(productConfig.combo_config);\n      \n      // Cargar productos para cada categoría del combo\n      const productsToLoad = {};\n      \n      for (const [categoryId, config] of Object.entries(productConfig.combo_config)) {\n        try {\n          // Obtener productos de la categoría\n          const categoryProducts = await woocommerceApi.getProducts({\n            category: categoryId,\n            status: 'publish',\n            per_page: 100\n          });\n          \n          productsToLoad[categoryId] = categoryProducts.filter(p => \n            p.id !== product.id && // Excluir el combo actual\n            p.status === 'publish' &&\n            p.catalog_visibility !== 'hidden'\n          );\n        } catch (err) {\n          console.error(`Error cargando productos de categoría ${categoryId}:`, err);\n          productsToLoad[categoryId] = [];\n        }\n      }\n      \n      setAvailableProducts(productsToLoad);\n      initializeSelections(productConfig.combo_config);\n      \n    } catch (error) {\n      console.error('Error cargando datos del combo:', error);\n      setError('Error al cargar las opciones del combo. Por favor, intenta nuevamente.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const initializeSelections = (comboConfig) => {\n    const initialSelections = {};\n    \n    Object.entries(comboConfig).forEach(([categoryId, config]) => {\n      initialSelections[categoryId] = [];\n    });\n    \n    setSelectedProducts(initialSelections);\n  };\n\n  const handleProductToggle = (categoryId, productId) => {\n    const category = comboConfig[categoryId];\n    const currentSelections = selectedProducts[categoryId] || [];\n    \n    if (currentSelections.includes(productId)) {\n      // Deseleccionar el producto\n      setSelectedProducts(prev => ({\n        ...prev,\n        [categoryId]: currentSelections.filter(id => id !== productId)\n      }));\n    } else {\n      // Seleccionar el producto\n      if (category.maxSelection === 1) {\n        // Si solo se permite una selección, reemplazar\n        setSelectedProducts(prev => ({\n          ...prev,\n          [categoryId]: [productId]\n        }));\n      } else {\n        // Para múltiples selecciones\n        if (currentSelections.length < category.maxSelection) {\n          setSelectedProducts(prev => ({\n            ...prev,\n            [categoryId]: [...currentSelections, productId]\n          }));\n        }\n      }\n    }\n  };\n\n  const isStepComplete = (categoryId) => {\n    const category = comboConfig[categoryId];\n    const selections = selectedProducts[categoryId] || [];\n    return selections.length >= category.minSelection;\n  };\n\n  const canProceed = () => {\n    const categoryIds = Object.keys(comboConfig);\n    \n    // Si estamos en el último paso de categorías, verificar si podemos ir al resumen\n    if (currentStep === categoryIds.length - 1) {\n      const currentCategoryId = categoryIds[currentStep];\n      return isStepComplete(currentCategoryId) && canAddToCart();\n    }\n    \n    // Para otros pasos, solo verificar si el paso actual está completo\n    if (currentStep < categoryIds.length) {\n      const currentCategoryId = categoryIds[currentStep];\n      return isStepComplete(currentCategoryId);\n    }\n    \n    return false;\n  };\n\n  const canAddToCart = () => {\n    return Object.entries(comboConfig).every(([categoryId, config]) => {\n      const selections = selectedProducts[categoryId] || [];\n      return selections.length >= config.minSelection;\n    });\n  };\n\n  const handleNextStep = () => {\n    const categoryIds = Object.keys(comboConfig);\n    \n    if (currentStep < categoryIds.length - 1) {\n      // Avanzar al siguiente paso de categoría\n      setAnimationClass('fade-exit-active');\n      setTimeout(() => {\n        setCurrentStep(currentStep + 1);\n        setAnimationClass('fade-enter-active');\n      }, 200);\n    } else if (currentStep === categoryIds.length - 1) {\n      // Ir al paso final de resumen\n      setAnimationClass('fade-exit-active');\n      setTimeout(() => {\n        setCurrentStep(categoryIds.length);\n        setAnimationClass('fade-enter-active');\n      }, 200);\n    }\n  };\n\n  const handlePreviousStep = () => {\n    if (currentStep > 0) {\n      setAnimationClass('fade-exit-active');\n      setTimeout(() => {\n        setCurrentStep(currentStep - 1);\n        setAnimationClass('fade-enter-active');\n      }, 200);\n    }\n  };\n\n  const handleStepClick = (index) => {\n    if (index <= currentStep || (index > 0 && isStepComplete(Object.keys(comboConfig)[index - 1]))) {\n      setAnimationClass('fade-exit-active');\n      setTimeout(() => {\n        setCurrentStep(index);\n        setAnimationClass('fade-enter-active');\n      }, 200);\n    }\n  };\n\n  const calculateTotalPrice = () => {\n    const basePrice = parseFloat(product.price) || 0;\n    return basePrice * quantity;\n  };\n\n  const formatPrice = (price) => {\n    return new Intl.NumberFormat('es-CL', {\n      style: 'currency',\n      currency: 'CLP',\n      minimumFractionDigits: 0,\n      maximumFractionDigits: 0\n    }).format(price);\n  };\n\n  const handleAddToCart = async () => {\n    if (!canAddToCart()) return;\n    \n    setAddingToCart(true);\n    \n    try {\n      // Preparar información del combo\n      const comboInfo = {\n        selections: {}\n      };\n      \n      // Mapear productos seleccionados con sus nombres\n      for (const [categoryId, productIds] of Object.entries(selectedProducts)) {\n        const categoryProducts = availableProducts[categoryId] || [];\n        comboInfo.selections[categoryId] = productIds.map(id => {\n          const product = categoryProducts.find(p => p.id === id);\n          return {\n            id,\n            name: product?.name || 'Producto'\n          };\n        });\n      }\n      \n      // Crear el item del carrito con la estructura esperada por CheckoutPage\n      const cartItem = {\n        // Usar un ID único para el item del carrito\n        id: `${product.id}-combo-${Date.now()}`,\n        // IMPORTANTE: Agregar productId que es lo que espera CheckoutPage\n        productId: product.id,\n        // Mantener el resto de la información\n        name: product.name,\n        price: parseFloat(product.price),\n        quantity: quantity,\n        image: product.images?.[0]?.src || null,\n        // Agregar customizations en el formato esperado\n        customizations: {\n          type: 'combo',\n          comboSelections: comboInfo.selections,\n          comboConfig: comboConfig,\n          // Agregar información adicional para el pedido\n          specialInstructions: '', // Por si se necesita después\n          productAddons: [] // Por compatibilidad con el checkout\n        }\n      };\n      \n      // Agregar al carrito\n      await addToCart(cartItem);\n      \n      // Cerrar modal con animación\n      modalRef.current?.classList.add('closing');\n      setTimeout(() => {\n        onClose();\n      }, 300);\n      \n    } catch (error) {\n      console.error('Error al agregar al carrito:', error);\n      setError('Error al agregar el combo al carrito');\n    } finally {\n      setAddingToCart(false);\n    }\n  };\n\n  const renderProgressSteps = () => {\n    if (!comboConfig) return null;\n    \n    const categoryIds = Object.keys(comboConfig);\n    const isLastStep = currentStep >= categoryIds.length;\n    \n    if (isLastStep) return null; // No mostrar en el paso final\n    \n    return (\n      <div className=\"progress-container\">\n        <div className=\"progress-steps\">\n          {categoryIds.map((categoryId, index) => {\n            const category = comboConfig[categoryId];\n            const isActive = index === currentStep;\n            const isCompleted = isStepComplete(categoryId) && index < currentStep;\n            const isClickable = index <= currentStep || (index > 0 && isStepComplete(categoryIds[index - 1]));\n            \n            return (\n              <React.Fragment key={categoryId}>\n                <div \n                  className={`progress-step ${isActive ? 'active' : ''} ${isCompleted ? 'completed' : ''}`}\n                  onClick={() => isClickable && handleStepClick(index)}\n                  style={{ cursor: isClickable ? 'pointer' : 'default' }}\n                >\n                  <div className=\"step-indicator\">\n                    {isCompleted ? <Check size={20} /> : index + 1}\n                  </div>\n                  <span className=\"step-label\">{category.name}</span>\n                </div>\n                {index < categoryIds.length - 1 && (\n                  <div className={`step-connector ${isCompleted ? 'completed' : ''}`} />\n                )}\n              </React.Fragment>\n            );\n          })}\n        </div>\n      </div>\n    );\n  };\n\n  const renderCategoryProducts = () => {\n    if (!comboConfig) return null;\n    \n    const categoryIds = Object.keys(comboConfig);\n    \n    // Verificar que no estamos en el paso final\n    if (currentStep >= categoryIds.length) return null;\n    \n    const currentCategoryId = categoryIds[currentStep];\n    const currentCategory = comboConfig[currentCategoryId];\n    const products = availableProducts[currentCategoryId] || [];\n    const selections = selectedProducts[currentCategoryId] || [];\n    \n    return (\n      <div className={`category-section ${animationClass}`}>\n        <div className=\"category-header\">\n          <h3 className=\"category-title\">{currentCategory.name}</h3>\n          <p className=\"category-description\">\n            Selecciona {currentCategory.minSelection === currentCategory.maxSelection \n              ? currentCategory.minSelection \n              : `entre ${currentCategory.minSelection} y ${currentCategory.maxSelection}`} \n            {currentCategory.minSelection === 1 ? ' opción' : ' opciones'}\n          </p>\n          {selections.length > 0 && (\n            <div className=\"selection-indicator\">\n              <Check size={16} />\n              {selections.length} de {currentCategory.maxSelection} seleccionado{selections.length !== 1 ? 's' : ''}\n            </div>\n          )}\n        </div>\n        \n        <div className=\"products-grid\">\n          {products.map(prod => {\n            const isSelected = selections.includes(prod.id);\n            const isDisabled = !isSelected && selections.length >= currentCategory.maxSelection;\n            \n            return (\n              <div\n                key={prod.id}\n                className={`product-card ${isSelected ? 'selected' : ''} ${isDisabled ? 'disabled' : ''}`}\n                onClick={() => !isDisabled && handleProductToggle(currentCategoryId, prod.id)}\n                tabIndex={0}\n                role=\"button\"\n                aria-pressed={isSelected}\n                onKeyPress={(e) => {\n                  if ((e.key === 'Enter' || e.key === ' ') && !isDisabled) {\n                    handleProductToggle(currentCategoryId, prod.id);\n                  }\n                }}\n              >\n                <div className=\"product-image-container\">\n                  {prod.images && prod.images[0] ? (\n                    <img \n                      src={prod.images[0].src} \n                      alt={prod.name}\n                      className=\"product-image\"\n                      loading=\"lazy\"\n                    />\n                  ) : (\n                    <div className=\"product-image-placeholder\">\n                      <Pizza size={40} />\n                    </div>\n                  )}\n                  <div className=\"selection-badge\">\n                    <Check size={20} />\n                  </div>\n                </div>\n                \n                <div className=\"product-info\">\n                  <h4 className=\"product-name\">{prod.name}</h4>\n                  <p className=\"product-description\" \n                     dangerouslySetInnerHTML={{ __html: prod.short_description || prod.description || '' }} />\n                </div>\n              </div>\n            );\n          })}\n        </div>\n        \n        {products.length === 0 && (\n          <div className=\"state-container\">\n            <Package size={64} color=\"var(--text-light)\" />\n            <p className=\"state-message\">No hay productos disponibles en esta categoría</p>\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  const renderFinalStep = () => {\n    return (\n      <div className=\"summary-section\">\n        <div className=\"summary-header\">\n          <h3 className=\"summary-title\">¡Tu combo está listo!</h3>\n          <p className=\"summary-price\">{formatPrice(product.price)}</p>\n        </div>\n\n        <div className=\"selections-summary\">\n          {Object.entries(selectedProducts).map(([categoryId, productIds]) => {\n            const category = comboConfig[categoryId];\n            const categoryProducts = availableProducts[categoryId] || [];\n            \n            if (productIds.length === 0) return null;\n            \n            return (\n              <div key={categoryId} className=\"selection-category\">\n                <h4 className=\"selection-category-name\">{category.name}</h4>\n                <div className=\"selected-items\">\n                  {productIds.map(id => {\n                    const product = categoryProducts.find(p => p.id === id);\n                    return (\n                      <span key={id} className=\"selected-item-tag\">\n                        {product?.name || 'Producto'}\n                      </span>\n                    );\n                  })}\n                </div>\n              </div>\n            );\n          })}\n        </div>\n\n        <div className=\"quantity-section\">\n          <div className=\"quantity-control\">\n            <span className=\"quantity-label\">Cantidad</span>\n            <div className=\"quantity-selector\">\n              <button \n                className=\"quantity-button\"\n                onClick={() => setQuantity(Math.max(1, quantity - 1))}\n                disabled={quantity <= 1}\n                aria-label=\"Disminuir cantidad\"\n              >\n                <Minus size={20} />\n              </button>\n              <span className=\"quantity-display\">{quantity}</span>\n              <button \n                className=\"quantity-button\"\n                onClick={() => setQuantity(quantity + 1)}\n                aria-label=\"Aumentar cantidad\"\n              >\n                <Plus size={20} />\n              </button>\n            </div>\n          </div>\n          \n          <div className=\"total-section\">\n            <p className=\"total-label\">Total</p>\n            <p className=\"total-amount\">{formatPrice(calculateTotalPrice())}</p>\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  if (!isOpen) return null;\n\n  const categoryIds = Object.keys(comboConfig || {});\n  const isLastStep = currentStep >= categoryIds.length;\n  const isOnCategoryStep = currentStep < categoryIds.length;\n\n  return (\n    <div className=\"combo-modal-overlay\" onClick={onClose}>\n      <div \n        ref={modalRef}\n        className=\"combo-modal\" \n        onClick={(e) => e.stopPropagation()}\n        role=\"dialog\"\n        aria-modal=\"true\"\n        aria-labelledby=\"combo-modal-title\"\n      >\n        <div className=\"modal-handle\" />\n        \n        <button \n          className=\"modal-close\" \n          onClick={onClose}\n          aria-label=\"Cerrar modal\"\n        >\n          <X size={24} />\n        </button>\n        \n        <div className=\"combo-header\">\n          <h2 id=\"combo-modal-title\" className=\"combo-title\">\n            {isLastStep ? 'Confirma tu pedido' : 'Arma tu combo perfecto'}\n          </h2>\n          <p className=\"combo-subtitle\">\n            {isLastStep \n              ? 'Revisa tu selección y agrega al carrito' \n              : `Personaliza tu ${product?.name || 'combo'} paso a paso`}\n          </p>\n        </div>\n        \n        {renderProgressSteps()}\n        \n        {loading ? (\n          <div className=\"state-container\">\n            <Loader className=\"loading-spinner\" size={48} />\n            <p className=\"state-message\">Cargando opciones del combo...</p>\n          </div>\n        ) : error ? (\n          <div className=\"state-container\">\n            <p className=\"error-message\">{error}</p>\n            <button onClick={loadComboData} className=\"retry-button\">\n              Reintentar\n            </button>\n          </div>\n        ) : (\n          <>\n            <div className=\"combo-content\">\n              {isOnCategoryStep ? renderCategoryProducts() : renderFinalStep()}\n            </div>\n\n            <div className=\"modal-footer\">\n              <button \n                className=\"nav-button secondary\"\n                onClick={handlePreviousStep}\n                disabled={currentStep === 0}\n              >\n                <ChevronLeft size={20} />\n                <span>Anterior</span>\n              </button>\n              \n              {isOnCategoryStep ? (\n                <button \n                  className=\"nav-button primary\"\n                  onClick={handleNextStep}\n                  disabled={!canProceed()}\n                >\n                  <span>Siguiente</span>\n                  <ChevronRight size={20} />\n                </button>\n              ) : (\n                <button \n                  className=\"add-to-cart-button\"\n                  onClick={handleAddToCart}\n                  disabled={addingToCart || !canAddToCart()}\n                >\n                  {addingToCart ? (\n                    <>\n                      <Loader className=\"loading-spinner\" size={20} />\n                      <span>Agregando...</span>\n                    </>\n                  ) : (\n                    <>\n                      <ShoppingCart size={20} />\n                      <span>Agregar al Carrito</span>\n                    </>\n                  )}\n                </button>\n              )}\n            </div>\n          </>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default ComboModal;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}