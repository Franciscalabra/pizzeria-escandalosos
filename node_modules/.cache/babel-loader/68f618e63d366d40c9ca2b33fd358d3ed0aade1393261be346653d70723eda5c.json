{"ast":null,"code":"import React,{useState,useEffect,useContext}from'react';import{useNavigate}from'react-router-dom';import{ArrowLeft,User,Phone,Mail,MapPin,Home,MessageSquare,DollarSign,CreditCard,Check,Truck,Store,Clock,AlertCircle,ChevronDown,ChevronUp,X,Loader}from'lucide-react';import{CartContext}from'../../context/CartContext';import woocommerceApi from'../../services/woocommerceApi';import'./CheckoutPage.css';// Agregar estilos en línea para el spinner si no están en el CSS\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const spinnerStyle=`\n  @keyframes spin {\n    from { transform: rotate(0deg); }\n    to { transform: rotate(360deg); }\n  }\n  .spinner {\n    animation: spin 1s linear infinite;\n  }\n`;const CheckoutPage=()=>{const navigate=useNavigate();const{cart,getCartTotal,clearCart,getItemCount}=useContext(CartContext);// Función para formatear precio\nconst formatPrice=price=>{return new Intl.NumberFormat('es-CL',{style:'currency',currency:'CLP'}).format(price);};// Estados principales\nconst[currentStep,setCurrentStep]=useState(1);const[orderType,setOrderType]=useState('delivery');const[loading,setLoading]=useState(false);const[initialLoading,setInitialLoading]=useState(true);const[orderSuccess,setOrderSuccess]=useState(false);const[orderId,setOrderId]=useState(null);const[showOrderSummary,setShowOrderSummary]=useState(true);// Estados para datos de WooCommerce\nconst[shippingMethods,setShippingMethods]=useState([]);const[selectedShippingMethod,setSelectedShippingMethod]=useState(null);const[paymentMethods,setPaymentMethods]=useState([]);const[storeInfo,setStoreInfo]=useState(null);const[deliveryFee,setDeliveryFee]=useState(0);// Estados del formulario con localStorage\nconst[formData,setFormData]=useState(()=>{const savedData=localStorage.getItem('checkoutFormData');return savedData?JSON.parse(savedData):{customerName:'',email:'',phone:'',address:'',neighborhood:'',reference:'',notes:'',paymentMethod:'',cashAmount:''};});// Estados para validación y autocompletado\nconst[errors,setErrors]=useState({});const[touched,setTouched]=useState({});const[savedAddresses]=useState(()=>{const saved=localStorage.getItem('savedAddresses');return saved?JSON.parse(saved):[];});const[showAddressSuggestions,setShowAddressSuggestions]=useState(false);// Cargar datos de WooCommerce al montar el componente\nuseEffect(()=>{const loadWooCommerceData=async()=>{setInitialLoading(true);try{// Cargar métodos de envío, métodos de pago e información de la tienda\nconst[shippingData,paymentData,storeData]=await Promise.all([woocommerceApi.getShippingMethods(),woocommerceApi.getPaymentGateways(),woocommerceApi.getStoreInfo()]);setShippingMethods(shippingData);setPaymentMethods(paymentData);setStoreInfo(storeData);// Establecer el primer método de pago disponible como predeterminado\nif(paymentData.length>0&&!formData.paymentMethod){setFormData(prev=>({...prev,paymentMethod:paymentData[0].id}));}// Calcular el costo de envío inicial\nif(shippingData.length>0){const defaultZone=shippingData[0];const shippingMethod=defaultZone.methods.find(m=>m.methodId==='flat_rate'||m.methodId==='local_delivery');if(shippingMethod){setSelectedShippingMethod(shippingMethod);const cost=woocommerceApi.calculateShippingCost(shippingData,getCartTotal());setDeliveryFee(cost);}}}catch(error){console.error('Error cargando datos de WooCommerce:',error);}finally{setInitialLoading(false);}};loadWooCommerceData();},[]);// Actualizar costo de envío cuando cambie el subtotal o el tipo de pedido\nuseEffect(()=>{if(orderType==='delivery'&&shippingMethods.length>0){const cost=woocommerceApi.calculateShippingCost(shippingMethods,getCartTotal());setDeliveryFee(cost);}},[orderType,shippingMethods,getCartTotal]);// Guardar progreso en localStorage\nuseEffect(()=>{if(!orderSuccess){localStorage.setItem('checkoutFormData',JSON.stringify(formData));}},[formData,orderSuccess]);// Limpiar localStorage al completar pedido\nuseEffect(()=>{if(orderSuccess){localStorage.removeItem('checkoutFormData');}},[orderSuccess]);// Redirigir si no hay items en el carrito\nuseEffect(()=>{if(cart.length===0&&!orderSuccess){navigate('/menu');}},[cart,navigate,orderSuccess]);// Validación en tiempo real\nconst validateField=(name,value)=>{let error='';switch(name){case'customerName':if(!value.trim())error='El nombre es requerido';else if(value.trim().length<3)error='El nombre debe tener al menos 3 caracteres';break;case'phone':const phoneRegex=/^(\\+56)?[9][0-9]{8}$/;if(!value)error='El teléfono es requerido';else if(!phoneRegex.test(value.replace(/\\s/g,'')))error='Formato inválido (ej: +56912345678)';break;case'email':const emailRegex=/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;if(!value)error='El email es requerido';else if(!emailRegex.test(value))error='Email inválido';break;case'address':if(orderType==='delivery'&&!value.trim())error='La dirección es requerida';break;case'neighborhood':if(orderType==='delivery'&&!value.trim())error='La comuna es requerida';break;case'cashAmount':if(formData.paymentMethod==='cod'&&value){const amount=parseFloat(value);const total=getCartTotal()+(orderType==='delivery'?deliveryFee:0);if(amount<total)error=`El monto debe ser mayor a ${formatPrice(total)}`;}break;default:break;}return error;};const handleInputChange=e=>{const{name,value}=e.target;setFormData(prev=>({...prev,[name]:value}));// Validación en tiempo real solo si el campo fue tocado\nif(touched[name]){const error=validateField(name,value);setErrors(prev=>({...prev,[name]:error}));}};const handleBlur=e=>{const{name,value}=e.target;setTouched(prev=>({...prev,[name]:true}));const error=validateField(name,value);setErrors(prev=>({...prev,[name]:error}));};const validateStep=step=>{let stepErrors={};switch(step){case 1:stepErrors.customerName=validateField('customerName',formData.customerName);stepErrors.phone=validateField('phone',formData.phone);stepErrors.email=validateField('email',formData.email);break;case 2:if(orderType==='delivery'){stepErrors.address=validateField('address',formData.address);stepErrors.neighborhood=validateField('neighborhood',formData.neighborhood);}break;case 3:if(formData.paymentMethod==='cod'&&formData.cashAmount){stepErrors.cashAmount=validateField('cashAmount',formData.cashAmount);}if(!formData.paymentMethod){stepErrors.paymentMethod='Debes seleccionar un método de pago';}break;default:break;}// Filtrar errores vacíos\nconst filteredErrors=Object.entries(stepErrors).reduce((acc,_ref)=>{let[key,value]=_ref;if(value)acc[key]=value;return acc;},{});setErrors(filteredErrors);return Object.keys(filteredErrors).length===0;};const handleNextStep=()=>{if(validateStep(currentStep)){setCurrentStep(prev=>Math.min(prev+1,3));window.scrollTo(0,0);}else{// Marcar todos los campos del paso actual como tocados\nconst fieldsToTouch=currentStep===1?['customerName','phone','email']:currentStep===2&&orderType==='delivery'?['address','neighborhood']:[];const newTouched=fieldsToTouch.reduce((acc,field)=>{acc[field]=true;return acc;},{});setTouched(prev=>({...prev,...newTouched}));}};const handlePrevStep=()=>{setCurrentStep(prev=>Math.max(prev-1,1));window.scrollTo(0,0);};const selectSavedAddress=address=>{setFormData(prev=>({...prev,address:address.address,neighborhood:address.neighborhood,reference:address.reference||''}));setShowAddressSuggestions(false);};const handleSubmitOrder=async()=>{if(!validateStep(3))return;setLoading(true);try{// Encontrar el método de pago seleccionado\nconst selectedPaymentMethod=paymentMethods.find(m=>m.id===formData.paymentMethod);const orderData={customerName:formData.customerName,email:formData.email,phone:formData.phone,orderType,items:cart.map(item=>({productId:item.productId,variationId:item.variationId,quantity:item.quantity,customizations:item.customizations})),address:orderType==='delivery'?formData.address:null,neighborhood:orderType==='delivery'?formData.neighborhood:null,reference:orderType==='delivery'?formData.reference:null,paymentMethod:formData.paymentMethod,paymentMethodTitle:(selectedPaymentMethod===null||selectedPaymentMethod===void 0?void 0:selectedPaymentMethod.title)||formData.paymentMethod,cashAmount:formData.paymentMethod==='cod'?formData.cashAmount:null,shippingMethod:orderType==='delivery'?selectedShippingMethod:null,notes:formData.notes};const order=await woocommerceApi.createOrder(orderData);setOrderId(order.id);setOrderSuccess(true);clearCart();// Guardar dirección si es nueva\nif(orderType==='delivery'&&formData.address){const newAddress={address:formData.address,neighborhood:formData.neighborhood,reference:formData.reference};const existingAddresses=JSON.parse(localStorage.getItem('savedAddresses')||'[]');const isDuplicate=existingAddresses.some(addr=>addr.address===newAddress.address&&addr.neighborhood===newAddress.neighborhood);if(!isDuplicate){existingAddresses.push(newAddress);localStorage.setItem('savedAddresses',JSON.stringify(existingAddresses));}}}catch(error){console.error('Error al crear pedido:',error);alert('Error al procesar el pedido. Por favor intenta nuevamente.');}finally{setLoading(false);}};// Función para obtener el ícono del método de pago\nconst getPaymentIcon=methodId=>{const icons={'cod':DollarSign,'bacs':DollarSign,'cheque':DollarSign,'paypal':CreditCard,'stripe':CreditCard,'mercadopago':CreditCard,'webpay':CreditCard,'transbank':CreditCard,'flow':CreditCard};return icons[methodId]||CreditCard;};const subtotal=getCartTotal();const total=subtotal+(orderType==='delivery'?deliveryFee:0);if(initialLoading){return/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-page\",children:[/*#__PURE__*/_jsx(\"style\",{children:spinnerStyle}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-loading\",style:{display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center',minHeight:'400px',gap:'1rem'},children:[/*#__PURE__*/_jsx(Loader,{className:\"spinner\",size:48}),/*#__PURE__*/_jsx(\"p\",{children:\"Cargando informaci\\xF3n...\"})]})]});}if(orderSuccess){return/*#__PURE__*/_jsx(\"div\",{className:\"checkout-page\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-success-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"checkout-success-icon\",children:/*#__PURE__*/_jsx(Check,{size:48})}),/*#__PURE__*/_jsx(\"h1\",{className:\"checkout-success-title\",children:\"\\xA1Gracias por tu pedido!\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"checkout-success-order\",children:[\"Pedido #\",orderId]}),/*#__PURE__*/_jsx(\"p\",{className:\"checkout-success-message\",children:orderType==='delivery'?`Tu pedido será entregado en ${(storeInfo===null||storeInfo===void 0?void 0:storeInfo.deliveryTime)||'30-45 minutos'}`:`Tu pedido estará listo para retirar en ${(storeInfo===null||storeInfo===void 0?void 0:storeInfo.pickupTime)||'20-30 minutos'}`}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-success-details\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Te hemos enviado un email con los detalles de tu pedido.\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Tambi\\xE9n recibir\\xE1s un WhatsApp con la confirmaci\\xF3n.\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",onClick:()=>navigate('/'),children:\"Volver al inicio\"})]})});}return/*#__PURE__*/_jsx(\"div\",{className:\"checkout-page\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-header\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"checkout-back-btn\",onClick:()=>currentStep>1?handlePrevStep():navigate('/cart'),\"aria-label\":\"Volver\",children:[/*#__PURE__*/_jsx(ArrowLeft,{size:20}),/*#__PURE__*/_jsx(\"span\",{children:\"Volver\"})]}),/*#__PURE__*/_jsx(\"h1\",{className:\"checkout-title\",children:\"Finalizar Pedido\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-progress\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"checkout-progress-bar\",children:/*#__PURE__*/_jsx(\"div\",{className:\"checkout-progress-fill\",style:{width:`${currentStep/3*100}%`}})}),/*#__PURE__*/_jsx(\"div\",{className:\"checkout-steps\",children:['Datos',orderType==='delivery'?'Dirección':'Retiro','Pago'].map((step,index)=>/*#__PURE__*/_jsxs(\"div\",{className:`checkout-step ${currentStep>index+1?'completed':''} ${currentStep===index+1?'active':''}`,children:[/*#__PURE__*/_jsx(\"div\",{className:\"checkout-step-circle\",children:currentStep>index+1?/*#__PURE__*/_jsx(Check,{size:16}):index+1}),/*#__PURE__*/_jsx(\"span\",{className:\"checkout-step-label\",children:step})]},step))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-main\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-content\",children:[currentStep===1&&/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-form-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-order-type\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"checkout-section-title\",children:\"\\xBFC\\xF3mo quieres recibir tu pedido?\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-order-options\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setOrderType('delivery'),className:`checkout-order-option ${orderType==='delivery'?'active':''}`,children:[/*#__PURE__*/_jsx(Truck,{size:32}),/*#__PURE__*/_jsx(\"h3\",{children:\"Delivery\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Recibe en tu domicilio\"}),/*#__PURE__*/_jsx(\"span\",{className:\"checkout-order-price\",children:deliveryFee>0?`Desde ${formatPrice(deliveryFee)}`:'Calculando...'})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setOrderType('pickup'),className:`checkout-order-option ${orderType==='pickup'?'active':''}`,children:[/*#__PURE__*/_jsx(Store,{size:32}),/*#__PURE__*/_jsx(\"h3\",{children:\"Retiro en Tienda\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Retira tu pedido\"}),/*#__PURE__*/_jsx(\"span\",{className:\"checkout-order-price checkout-order-free\",children:\"Sin costo\"})]})]})]}),/*#__PURE__*/_jsx(\"h2\",{className:\"checkout-section-title\",children:\"Informaci\\xF3n Personal\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"checkout-form-label\",children:[/*#__PURE__*/_jsx(User,{size:18}),\"Nombre completo\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"customerName\",value:formData.customerName,onChange:handleInputChange,onBlur:handleBlur,className:`checkout-form-input ${errors.customerName&&touched.customerName?'error':''}`,placeholder:\"Juan P\\xE9rez\"}),errors.customerName&&touched.customerName&&/*#__PURE__*/_jsx(\"span\",{className:\"checkout-form-error\",children:errors.customerName})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"checkout-form-label\",children:[/*#__PURE__*/_jsx(Phone,{size:18}),\"Tel\\xE9fono\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",name:\"phone\",value:formData.phone,onChange:handleInputChange,onBlur:handleBlur,className:`checkout-form-input ${errors.phone&&touched.phone?'error':''}`,placeholder:\"+56912345678\"}),errors.phone&&touched.phone&&/*#__PURE__*/_jsx(\"span\",{className:\"checkout-form-error\",children:errors.phone}),/*#__PURE__*/_jsx(\"span\",{className:\"checkout-form-hint\",children:\"Te contactaremos por WhatsApp\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"checkout-form-label\",children:[/*#__PURE__*/_jsx(Mail,{size:18}),\"Email\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",value:formData.email,onChange:handleInputChange,onBlur:handleBlur,className:`checkout-form-input ${errors.email&&touched.email?'error':''}`,placeholder:\"juan@ejemplo.com\"}),errors.email&&touched.email&&/*#__PURE__*/_jsx(\"span\",{className:\"checkout-form-error\",children:errors.email})]})]}),currentStep===2&&/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-form-section\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"checkout-section-title\",children:orderType==='delivery'?'Dirección de Entrega':'Información de Retiro'}),orderType==='delivery'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"checkout-form-label\",children:[/*#__PURE__*/_jsx(MapPin,{size:18}),\"Direcci\\xF3n completa\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-input-wrapper\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"address\",value:formData.address,onChange:handleInputChange,onBlur:handleBlur,onFocus:()=>setShowAddressSuggestions(true),className:`checkout-form-input ${errors.address&&touched.address?'error':''}`,placeholder:\"Av. Principal 123, Depto 45\"}),showAddressSuggestions&&savedAddresses.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-address-suggestions\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"suggestions-header\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Direcciones guardadas\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowAddressSuggestions(false),children:/*#__PURE__*/_jsx(X,{size:16})})]}),savedAddresses.map((addr,index)=>/*#__PURE__*/_jsxs(\"button\",{className:\"suggestion-item\",onClick:()=>selectSavedAddress(addr),children:[/*#__PURE__*/_jsx(MapPin,{size:16}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:addr.address}),/*#__PURE__*/_jsx(\"span\",{children:addr.neighborhood})]})]},index))]})]}),errors.address&&touched.address&&/*#__PURE__*/_jsx(\"span\",{className:\"checkout-form-error\",children:errors.address})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"checkout-form-label\",children:[/*#__PURE__*/_jsx(Home,{size:18}),\"Comuna\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"neighborhood\",value:formData.neighborhood,onChange:handleInputChange,onBlur:handleBlur,className:`checkout-form-input ${errors.neighborhood&&touched.neighborhood?'error':''}`,placeholder:\"Providencia\"}),errors.neighborhood&&touched.neighborhood&&/*#__PURE__*/_jsx(\"span\",{className:\"checkout-form-error\",children:errors.neighborhood})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"checkout-form-label\",children:[/*#__PURE__*/_jsx(MessageSquare,{size:18}),\"Referencias (opcional)\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"reference\",value:formData.reference,onChange:handleInputChange,className:\"checkout-form-input\",placeholder:\"Entre calle A y B, casa azul\"}),/*#__PURE__*/_jsx(\"span\",{className:\"checkout-form-hint\",children:\"Ayuda al repartidor a encontrarte\"})]})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-pickup-info\",children:[/*#__PURE__*/_jsx(Clock,{size:48,className:\"checkout-pickup-icon\"}),/*#__PURE__*/_jsxs(\"h3\",{children:[\"Tu pedido estar\\xE1 listo en \",(storeInfo===null||storeInfo===void 0?void 0:storeInfo.pickupTime)||'20-30 minutos']}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-pickup-details\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Direcci\\xF3n:\"}),\" \",storeInfo!==null&&storeInfo!==void 0&&storeInfo.address?`${storeInfo.address}, ${storeInfo.city}`:'Cargando dirección...']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Horario:\"}),\" \",storeInfo!==null&&storeInfo!==void 0&&storeInfo.schedule?Object.entries(storeInfo.schedule).map(_ref2=>{let[key,value]=_ref2;return/*#__PURE__*/_jsxs(\"span\",{children:[value.label,\": \",value.open,\" - \",value.close,/*#__PURE__*/_jsx(\"br\",{})]},key);}):'Cargando horarios...']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Tel\\xE9fono:\"}),\" \",(storeInfo===null||storeInfo===void 0?void 0:storeInfo.phone)||'Cargando...']})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-pickup-note\",children:[/*#__PURE__*/_jsx(AlertCircle,{size:16}),/*#__PURE__*/_jsx(\"p\",{children:\"Te enviaremos un WhatsApp cuando tu pedido est\\xE9 listo\"})]})]})]}),currentStep===3&&/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-form-section\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"checkout-section-title\",children:\"M\\xE9todo de Pago\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-payment-options\",children:[paymentMethods.length>0?paymentMethods.map(method=>{const IconComponent=getPaymentIcon(method.id);const isDisabled=false;// Todos los métodos habilitados desde WooCommerce están disponibles\nreturn/*#__PURE__*/_jsxs(\"label\",{className:`checkout-payment-option ${isDisabled?'disabled':''}`,children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"paymentMethod\",value:method.id,checked:formData.paymentMethod===method.id,onChange:handleInputChange,disabled:isDisabled}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-payment-content\",children:[/*#__PURE__*/_jsx(IconComponent,{size:24}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:method.title}),/*#__PURE__*/_jsx(\"p\",{children:method.description||'Método de pago disponible'})]})]})]},method.id);}):/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-no-payment-methods\",children:[/*#__PURE__*/_jsx(AlertCircle,{size:32}),/*#__PURE__*/_jsx(\"p\",{children:\"No hay m\\xE9todos de pago disponibles\"})]}),formData.paymentMethod==='cod'&&/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-cash-amount\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"checkout-form-label\",children:\"\\xBFCon cu\\xE1nto pagar\\xE1s? (opcional)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"cashAmount\",value:formData.cashAmount,onChange:handleInputChange,onBlur:handleBlur,className:`checkout-form-input ${errors.cashAmount?'error':''}`,placeholder:formatPrice(Math.ceil(total/1000)*1000),min:total}),errors.cashAmount&&/*#__PURE__*/_jsx(\"span\",{className:\"checkout-form-error\",children:errors.cashAmount}),/*#__PURE__*/_jsx(\"span\",{className:\"checkout-form-hint\",children:\"Para preparar tu vuelto\"})]})]}),errors.paymentMethod&&/*#__PURE__*/_jsx(\"span\",{className:\"checkout-form-error\",children:errors.paymentMethod}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"checkout-form-label\",children:[/*#__PURE__*/_jsx(MessageSquare,{size:18}),\"Notas adicionales (opcional)\"]}),/*#__PURE__*/_jsx(\"textarea\",{name:\"notes\",value:formData.notes,onChange:handleInputChange,className:\"checkout-form-input checkout-textarea\",placeholder:\"Ej: Sin cebolla, extra picante, etc.\",rows:3})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-sidebar\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-order-summary\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"checkout-summary-toggle\",onClick:()=>setShowOrderSummary(!showOrderSummary),children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Resumen del Pedido\"}),showOrderSummary?/*#__PURE__*/_jsx(ChevronUp,{size:20}):/*#__PURE__*/_jsx(ChevronDown,{size:20})]}),showOrderSummary&&/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-summary-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"checkout-summary-items\",children:cart.map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-summary-item\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[item.quantity,\"x \",item.name]}),/*#__PURE__*/_jsx(\"span\",{children:formatPrice(item.price*item.quantity)})]},item.id))}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-summary-totals\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-summary-row\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Subtotal\"}),/*#__PURE__*/_jsx(\"span\",{children:formatPrice(subtotal)})]}),orderType==='delivery'&&/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-summary-row\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Delivery\"}),/*#__PURE__*/_jsx(\"span\",{children:deliveryFee>0?formatPrice(deliveryFee):'Envío gratis'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-summary-row checkout-summary-total\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Total\"}),/*#__PURE__*/_jsx(\"span\",{children:formatPrice(total)})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-actions\",children:[currentStep<3?/*#__PURE__*/_jsx(\"button\",{onClick:handleNextStep,className:\"btn btn-primary checkout-continue-btn\",children:\"Continuar\"}):/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmitOrder,disabled:loading||!formData.paymentMethod,className:\"btn btn-primary checkout-confirm-btn\",children:loading?'Procesando...':'Confirmar Pedido'}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/cart'),className:\"btn btn-secondary\",children:\"Volver al carrito\"})]})]})]})]})});};export default CheckoutPage;","map":{"version":3,"names":["React","useState","useEffect","useContext","useNavigate","ArrowLeft","User","Phone","Mail","MapPin","Home","MessageSquare","DollarSign","CreditCard","Check","Truck","Store","Clock","AlertCircle","ChevronDown","ChevronUp","X","Loader","CartContext","woocommerceApi","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","spinnerStyle","CheckoutPage","navigate","cart","getCartTotal","clearCart","getItemCount","formatPrice","price","Intl","NumberFormat","style","currency","format","currentStep","setCurrentStep","orderType","setOrderType","loading","setLoading","initialLoading","setInitialLoading","orderSuccess","setOrderSuccess","orderId","setOrderId","showOrderSummary","setShowOrderSummary","shippingMethods","setShippingMethods","selectedShippingMethod","setSelectedShippingMethod","paymentMethods","setPaymentMethods","storeInfo","setStoreInfo","deliveryFee","setDeliveryFee","formData","setFormData","savedData","localStorage","getItem","JSON","parse","customerName","email","phone","address","neighborhood","reference","notes","paymentMethod","cashAmount","errors","setErrors","touched","setTouched","savedAddresses","saved","showAddressSuggestions","setShowAddressSuggestions","loadWooCommerceData","shippingData","paymentData","storeData","Promise","all","getShippingMethods","getPaymentGateways","getStoreInfo","length","prev","id","defaultZone","shippingMethod","methods","find","m","methodId","cost","calculateShippingCost","error","console","setItem","stringify","removeItem","validateField","name","value","trim","phoneRegex","test","replace","emailRegex","amount","parseFloat","total","handleInputChange","e","target","handleBlur","validateStep","step","stepErrors","filteredErrors","Object","entries","reduce","acc","_ref","key","keys","handleNextStep","Math","min","window","scrollTo","fieldsToTouch","newTouched","field","handlePrevStep","max","selectSavedAddress","handleSubmitOrder","selectedPaymentMethod","orderData","items","map","item","productId","variationId","quantity","customizations","paymentMethodTitle","title","order","createOrder","newAddress","existingAddresses","isDuplicate","some","addr","push","alert","getPaymentIcon","icons","subtotal","className","children","display","flexDirection","alignItems","justifyContent","minHeight","gap","size","deliveryTime","pickupTime","onClick","width","index","type","onChange","onBlur","placeholder","onFocus","city","schedule","_ref2","label","open","close","method","IconComponent","isDisabled","checked","disabled","description","ceil","rows"],"sources":["/Users/franciscalabra/Desktop/pizzeria-escandalosos/src/components/Checkout/CheckoutPage.jsx"],"sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { \n  ArrowLeft, \n  User, \n  Phone, \n  Mail, \n  MapPin, \n  Home,\n  MessageSquare,\n  DollarSign,\n  CreditCard,\n  Check,\n  Truck,\n  Store,\n  Clock,\n  AlertCircle,\n  ChevronDown,\n  ChevronUp,\n  X,\n  Loader\n} from 'lucide-react';\nimport { CartContext } from '../../context/CartContext';\nimport woocommerceApi from '../../services/woocommerceApi';\nimport './CheckoutPage.css';\n\n// Agregar estilos en línea para el spinner si no están en el CSS\nconst spinnerStyle = `\n  @keyframes spin {\n    from { transform: rotate(0deg); }\n    to { transform: rotate(360deg); }\n  }\n  .spinner {\n    animation: spin 1s linear infinite;\n  }\n`;\n\nconst CheckoutPage = () => {\n  const navigate = useNavigate();\n  const { cart, getCartTotal, clearCart, getItemCount } = useContext(CartContext);\n  \n  // Función para formatear precio\n  const formatPrice = (price) => {\n    return new Intl.NumberFormat('es-CL', {\n      style: 'currency',\n      currency: 'CLP'\n    }).format(price);\n  };\n  \n  // Estados principales\n  const [currentStep, setCurrentStep] = useState(1);\n  const [orderType, setOrderType] = useState('delivery');\n  const [loading, setLoading] = useState(false);\n  const [initialLoading, setInitialLoading] = useState(true);\n  const [orderSuccess, setOrderSuccess] = useState(false);\n  const [orderId, setOrderId] = useState(null);\n  const [showOrderSummary, setShowOrderSummary] = useState(true);\n  \n  // Estados para datos de WooCommerce\n  const [shippingMethods, setShippingMethods] = useState([]);\n  const [selectedShippingMethod, setSelectedShippingMethod] = useState(null);\n  const [paymentMethods, setPaymentMethods] = useState([]);\n  const [storeInfo, setStoreInfo] = useState(null);\n  const [deliveryFee, setDeliveryFee] = useState(0);\n  \n  // Estados del formulario con localStorage\n  const [formData, setFormData] = useState(() => {\n    const savedData = localStorage.getItem('checkoutFormData');\n    return savedData ? JSON.parse(savedData) : {\n      customerName: '',\n      email: '',\n      phone: '',\n      address: '',\n      neighborhood: '',\n      reference: '',\n      notes: '',\n      paymentMethod: '',\n      cashAmount: ''\n    };\n  });\n  \n  // Estados para validación y autocompletado\n  const [errors, setErrors] = useState({});\n  const [touched, setTouched] = useState({});\n  const [savedAddresses] = useState(() => {\n    const saved = localStorage.getItem('savedAddresses');\n    return saved ? JSON.parse(saved) : [];\n  });\n  const [showAddressSuggestions, setShowAddressSuggestions] = useState(false);\n\n  // Cargar datos de WooCommerce al montar el componente\n  useEffect(() => {\n    const loadWooCommerceData = async () => {\n      setInitialLoading(true);\n      try {\n        // Cargar métodos de envío, métodos de pago e información de la tienda\n        const [shippingData, paymentData, storeData] = await Promise.all([\n          woocommerceApi.getShippingMethods(),\n          woocommerceApi.getPaymentGateways(),\n          woocommerceApi.getStoreInfo()\n        ]);\n        \n        setShippingMethods(shippingData);\n        setPaymentMethods(paymentData);\n        setStoreInfo(storeData);\n        \n        // Establecer el primer método de pago disponible como predeterminado\n        if (paymentData.length > 0 && !formData.paymentMethod) {\n          setFormData(prev => ({ ...prev, paymentMethod: paymentData[0].id }));\n        }\n        \n        // Calcular el costo de envío inicial\n        if (shippingData.length > 0) {\n          const defaultZone = shippingData[0];\n          const shippingMethod = defaultZone.methods.find(m => \n            m.methodId === 'flat_rate' || m.methodId === 'local_delivery'\n          );\n          \n          if (shippingMethod) {\n            setSelectedShippingMethod(shippingMethod);\n            const cost = woocommerceApi.calculateShippingCost(\n              shippingData, \n              getCartTotal()\n            );\n            setDeliveryFee(cost);\n          }\n        }\n      } catch (error) {\n        console.error('Error cargando datos de WooCommerce:', error);\n      } finally {\n        setInitialLoading(false);\n      }\n    };\n    \n    loadWooCommerceData();\n  }, []);\n\n  // Actualizar costo de envío cuando cambie el subtotal o el tipo de pedido\n  useEffect(() => {\n    if (orderType === 'delivery' && shippingMethods.length > 0) {\n      const cost = woocommerceApi.calculateShippingCost(\n        shippingMethods, \n        getCartTotal()\n      );\n      setDeliveryFee(cost);\n    }\n  }, [orderType, shippingMethods, getCartTotal]);\n\n  // Guardar progreso en localStorage\n  useEffect(() => {\n    if (!orderSuccess) {\n      localStorage.setItem('checkoutFormData', JSON.stringify(formData));\n    }\n  }, [formData, orderSuccess]);\n\n  // Limpiar localStorage al completar pedido\n  useEffect(() => {\n    if (orderSuccess) {\n      localStorage.removeItem('checkoutFormData');\n    }\n  }, [orderSuccess]);\n\n  // Redirigir si no hay items en el carrito\n  useEffect(() => {\n    if (cart.length === 0 && !orderSuccess) {\n      navigate('/menu');\n    }\n  }, [cart, navigate, orderSuccess]);\n\n  // Validación en tiempo real\n  const validateField = (name, value) => {\n    let error = '';\n    \n    switch (name) {\n      case 'customerName':\n        if (!value.trim()) error = 'El nombre es requerido';\n        else if (value.trim().length < 3) error = 'El nombre debe tener al menos 3 caracteres';\n        break;\n      \n      case 'phone':\n        const phoneRegex = /^(\\+56)?[9][0-9]{8}$/;\n        if (!value) error = 'El teléfono es requerido';\n        else if (!phoneRegex.test(value.replace(/\\s/g, ''))) error = 'Formato inválido (ej: +56912345678)';\n        break;\n      \n      case 'email':\n        const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n        if (!value) error = 'El email es requerido';\n        else if (!emailRegex.test(value)) error = 'Email inválido';\n        break;\n      \n      case 'address':\n        if (orderType === 'delivery' && !value.trim()) error = 'La dirección es requerida';\n        break;\n      \n      case 'neighborhood':\n        if (orderType === 'delivery' && !value.trim()) error = 'La comuna es requerida';\n        break;\n      \n      case 'cashAmount':\n        if (formData.paymentMethod === 'cod' && value) {\n          const amount = parseFloat(value);\n          const total = getCartTotal() + (orderType === 'delivery' ? deliveryFee : 0);\n          if (amount < total) error = `El monto debe ser mayor a ${formatPrice(total)}`;\n        }\n        break;\n      \n      default:\n        break;\n    }\n    \n    return error;\n  };\n\n  const handleInputChange = (e) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({ ...prev, [name]: value }));\n    \n    // Validación en tiempo real solo si el campo fue tocado\n    if (touched[name]) {\n      const error = validateField(name, value);\n      setErrors(prev => ({ ...prev, [name]: error }));\n    }\n  };\n\n  const handleBlur = (e) => {\n    const { name, value } = e.target;\n    setTouched(prev => ({ ...prev, [name]: true }));\n    const error = validateField(name, value);\n    setErrors(prev => ({ ...prev, [name]: error }));\n  };\n\n  const validateStep = (step) => {\n    let stepErrors = {};\n    \n    switch (step) {\n      case 1:\n        stepErrors.customerName = validateField('customerName', formData.customerName);\n        stepErrors.phone = validateField('phone', formData.phone);\n        stepErrors.email = validateField('email', formData.email);\n        break;\n      \n      case 2:\n        if (orderType === 'delivery') {\n          stepErrors.address = validateField('address', formData.address);\n          stepErrors.neighborhood = validateField('neighborhood', formData.neighborhood);\n        }\n        break;\n      \n      case 3:\n        if (formData.paymentMethod === 'cod' && formData.cashAmount) {\n          stepErrors.cashAmount = validateField('cashAmount', formData.cashAmount);\n        }\n        if (!formData.paymentMethod) {\n          stepErrors.paymentMethod = 'Debes seleccionar un método de pago';\n        }\n        break;\n      \n      default:\n        break;\n    }\n    \n    // Filtrar errores vacíos\n    const filteredErrors = Object.entries(stepErrors).reduce((acc, [key, value]) => {\n      if (value) acc[key] = value;\n      return acc;\n    }, {});\n    \n    setErrors(filteredErrors);\n    return Object.keys(filteredErrors).length === 0;\n  };\n\n  const handleNextStep = () => {\n    if (validateStep(currentStep)) {\n      setCurrentStep(prev => Math.min(prev + 1, 3));\n      window.scrollTo(0, 0);\n    } else {\n      // Marcar todos los campos del paso actual como tocados\n      const fieldsToTouch = currentStep === 1 \n        ? ['customerName', 'phone', 'email']\n        : currentStep === 2 && orderType === 'delivery'\n        ? ['address', 'neighborhood']\n        : [];\n      \n      const newTouched = fieldsToTouch.reduce((acc, field) => {\n        acc[field] = true;\n        return acc;\n      }, {});\n      \n      setTouched(prev => ({ ...prev, ...newTouched }));\n    }\n  };\n\n  const handlePrevStep = () => {\n    setCurrentStep(prev => Math.max(prev - 1, 1));\n    window.scrollTo(0, 0);\n  };\n\n  const selectSavedAddress = (address) => {\n    setFormData(prev => ({\n      ...prev,\n      address: address.address,\n      neighborhood: address.neighborhood,\n      reference: address.reference || ''\n    }));\n    setShowAddressSuggestions(false);\n  };\n\n  const handleSubmitOrder = async () => {\n    if (!validateStep(3)) return;\n    \n    setLoading(true);\n    \n    try {\n      // Encontrar el método de pago seleccionado\n      const selectedPaymentMethod = paymentMethods.find(m => m.id === formData.paymentMethod);\n      \n      const orderData = {\n        customerName: formData.customerName,\n        email: formData.email,\n        phone: formData.phone,\n        orderType,\n        items: cart.map(item => ({\n          productId: item.productId,\n          variationId: item.variationId,\n          quantity: item.quantity,\n          customizations: item.customizations\n        })),\n        address: orderType === 'delivery' ? formData.address : null,\n        neighborhood: orderType === 'delivery' ? formData.neighborhood : null,\n        reference: orderType === 'delivery' ? formData.reference : null,\n        paymentMethod: formData.paymentMethod,\n        paymentMethodTitle: selectedPaymentMethod?.title || formData.paymentMethod,\n        cashAmount: formData.paymentMethod === 'cod' ? formData.cashAmount : null,\n        shippingMethod: orderType === 'delivery' ? selectedShippingMethod : null,\n        notes: formData.notes\n      };\n\n      const order = await woocommerceApi.createOrder(orderData);\n      \n      setOrderId(order.id);\n      setOrderSuccess(true);\n      clearCart();\n      \n      // Guardar dirección si es nueva\n      if (orderType === 'delivery' && formData.address) {\n        const newAddress = {\n          address: formData.address,\n          neighborhood: formData.neighborhood,\n          reference: formData.reference\n        };\n        \n        const existingAddresses = JSON.parse(localStorage.getItem('savedAddresses') || '[]');\n        const isDuplicate = existingAddresses.some(addr => \n          addr.address === newAddress.address && \n          addr.neighborhood === newAddress.neighborhood\n        );\n        \n        if (!isDuplicate) {\n          existingAddresses.push(newAddress);\n          localStorage.setItem('savedAddresses', JSON.stringify(existingAddresses));\n        }\n      }\n      \n    } catch (error) {\n      console.error('Error al crear pedido:', error);\n      alert('Error al procesar el pedido. Por favor intenta nuevamente.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Función para obtener el ícono del método de pago\n  const getPaymentIcon = (methodId) => {\n    const icons = {\n      'cod': DollarSign,\n      'bacs': DollarSign,\n      'cheque': DollarSign,\n      'paypal': CreditCard,\n      'stripe': CreditCard,\n      'mercadopago': CreditCard,\n      'webpay': CreditCard,\n      'transbank': CreditCard,\n      'flow': CreditCard\n    };\n    \n    return icons[methodId] || CreditCard;\n  };\n\n  const subtotal = getCartTotal();\n  const total = subtotal + (orderType === 'delivery' ? deliveryFee : 0);\n\n  if (initialLoading) {\n    return (\n      <div className=\"checkout-page\">\n        <style>{spinnerStyle}</style>\n        <div className=\"checkout-loading\" style={{\n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'center',\n          justifyContent: 'center',\n          minHeight: '400px',\n          gap: '1rem'\n        }}>\n          <Loader className=\"spinner\" size={48} />\n          <p>Cargando información...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (orderSuccess) {\n    return (\n      <div className=\"checkout-page\">\n        <div className=\"checkout-success-container\">\n          <div className=\"checkout-success-icon\">\n            <Check size={48} />\n          </div>\n          <h1 className=\"checkout-success-title\">¡Gracias por tu pedido!</h1>\n          <p className=\"checkout-success-order\">Pedido #{orderId}</p>\n          <p className=\"checkout-success-message\">\n            {orderType === 'delivery' \n              ? `Tu pedido será entregado en ${storeInfo?.deliveryTime || '30-45 minutos'}`\n              : `Tu pedido estará listo para retirar en ${storeInfo?.pickupTime || '20-30 minutos'}`\n            }\n          </p>\n          <div className=\"checkout-success-details\">\n            <p>Te hemos enviado un email con los detalles de tu pedido.</p>\n            <p>También recibirás un WhatsApp con la confirmación.</p>\n          </div>\n          <button \n            className=\"btn btn-primary\"\n            onClick={() => navigate('/')}\n          >\n            Volver al inicio\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"checkout-page\">\n      <div className=\"checkout-container\">\n        {/* Header */}\n        <div className=\"checkout-header\">\n          <button \n            className=\"checkout-back-btn\"\n            onClick={() => currentStep > 1 ? handlePrevStep() : navigate('/cart')}\n            aria-label=\"Volver\"\n          >\n            <ArrowLeft size={20} />\n            <span>Volver</span>\n          </button>\n          <h1 className=\"checkout-title\">Finalizar Pedido</h1>\n        </div>\n\n        {/* Progress Bar */}\n        <div className=\"checkout-progress\">\n          <div className=\"checkout-progress-bar\">\n            <div \n              className=\"checkout-progress-fill\"\n              style={{ width: `${(currentStep / 3) * 100}%` }}\n            />\n          </div>\n          <div className=\"checkout-steps\">\n            {['Datos', orderType === 'delivery' ? 'Dirección' : 'Retiro', 'Pago'].map((step, index) => (\n              <div \n                key={step}\n                className={`checkout-step ${currentStep > index + 1 ? 'completed' : ''} ${currentStep === index + 1 ? 'active' : ''}`}\n              >\n                <div className=\"checkout-step-circle\">\n                  {currentStep > index + 1 ? <Check size={16} /> : index + 1}\n                </div>\n                <span className=\"checkout-step-label\">{step}</span>\n              </div>\n            ))}\n          </div>\n        </div>\n\n        <div className=\"checkout-main\">\n          {/* Main Content */}\n          <div className=\"checkout-content\">\n            {/* Step 1: Información Personal */}\n            {currentStep === 1 && (\n              <div className=\"checkout-form-section\">\n                {/* Tipo de pedido */}\n                <div className=\"checkout-order-type\">\n                  <h2 className=\"checkout-section-title\">¿Cómo quieres recibir tu pedido?</h2>\n                  <div className=\"checkout-order-options\">\n                    <button\n                      onClick={() => setOrderType('delivery')}\n                      className={`checkout-order-option ${orderType === 'delivery' ? 'active' : ''}`}\n                    >\n                      <Truck size={32} />\n                      <h3>Delivery</h3>\n                      <p>Recibe en tu domicilio</p>\n                      <span className=\"checkout-order-price\">\n                        {deliveryFee > 0 ? `Desde ${formatPrice(deliveryFee)}` : 'Calculando...'}\n                      </span>\n                    </button>\n\n                    <button\n                      onClick={() => setOrderType('pickup')}\n                      className={`checkout-order-option ${orderType === 'pickup' ? 'active' : ''}`}\n                    >\n                      <Store size={32} />\n                      <h3>Retiro en Tienda</h3>\n                      <p>Retira tu pedido</p>\n                      <span className=\"checkout-order-price checkout-order-free\">Sin costo</span>\n                    </button>\n                  </div>\n                </div>\n\n                <h2 className=\"checkout-section-title\">Información Personal</h2>\n                \n                <div className=\"checkout-form-group\">\n                  <label className=\"checkout-form-label\">\n                    <User size={18} />\n                    Nombre completo\n                  </label>\n                  <input\n                    type=\"text\"\n                    name=\"customerName\"\n                    value={formData.customerName}\n                    onChange={handleInputChange}\n                    onBlur={handleBlur}\n                    className={`checkout-form-input ${errors.customerName && touched.customerName ? 'error' : ''}`}\n                    placeholder=\"Juan Pérez\"\n                  />\n                  {errors.customerName && touched.customerName && (\n                    <span className=\"checkout-form-error\">{errors.customerName}</span>\n                  )}\n                </div>\n\n                <div className=\"checkout-form-group\">\n                  <label className=\"checkout-form-label\">\n                    <Phone size={18} />\n                    Teléfono\n                  </label>\n                  <input\n                    type=\"tel\"\n                    name=\"phone\"\n                    value={formData.phone}\n                    onChange={handleInputChange}\n                    onBlur={handleBlur}\n                    className={`checkout-form-input ${errors.phone && touched.phone ? 'error' : ''}`}\n                    placeholder=\"+56912345678\"\n                  />\n                  {errors.phone && touched.phone && (\n                    <span className=\"checkout-form-error\">{errors.phone}</span>\n                  )}\n                  <span className=\"checkout-form-hint\">Te contactaremos por WhatsApp</span>\n                </div>\n\n                <div className=\"checkout-form-group\">\n                  <label className=\"checkout-form-label\">\n                    <Mail size={18} />\n                    Email\n                  </label>\n                  <input\n                    type=\"email\"\n                    name=\"email\"\n                    value={formData.email}\n                    onChange={handleInputChange}\n                    onBlur={handleBlur}\n                    className={`checkout-form-input ${errors.email && touched.email ? 'error' : ''}`}\n                    placeholder=\"juan@ejemplo.com\"\n                  />\n                  {errors.email && touched.email && (\n                    <span className=\"checkout-form-error\">{errors.email}</span>\n                  )}\n                </div>\n              </div>\n            )}\n\n            {/* Step 2: Dirección o Información de Retiro */}\n            {currentStep === 2 && (\n              <div className=\"checkout-form-section\">\n                <h2 className=\"checkout-section-title\">\n                  {orderType === 'delivery' ? 'Dirección de Entrega' : 'Información de Retiro'}\n                </h2>\n                \n                {orderType === 'delivery' ? (\n                  <>\n                    <div className=\"checkout-form-group\">\n                      <label className=\"checkout-form-label\">\n                        <MapPin size={18} />\n                        Dirección completa\n                      </label>\n                      <div className=\"checkout-input-wrapper\">\n                        <input\n                          type=\"text\"\n                          name=\"address\"\n                          value={formData.address}\n                          onChange={handleInputChange}\n                          onBlur={handleBlur}\n                          onFocus={() => setShowAddressSuggestions(true)}\n                          className={`checkout-form-input ${errors.address && touched.address ? 'error' : ''}`}\n                          placeholder=\"Av. Principal 123, Depto 45\"\n                        />\n                        \n                        {showAddressSuggestions && savedAddresses.length > 0 && (\n                          <div className=\"checkout-address-suggestions\">\n                            <div className=\"suggestions-header\">\n                              <span>Direcciones guardadas</span>\n                              <button onClick={() => setShowAddressSuggestions(false)}>\n                                <X size={16} />\n                              </button>\n                            </div>\n                            {savedAddresses.map((addr, index) => (\n                              <button\n                                key={index}\n                                className=\"suggestion-item\"\n                                onClick={() => selectSavedAddress(addr)}\n                              >\n                                <MapPin size={16} />\n                                <div>\n                                  <p>{addr.address}</p>\n                                  <span>{addr.neighborhood}</span>\n                                </div>\n                              </button>\n                            ))}\n                          </div>\n                        )}\n                      </div>\n                      {errors.address && touched.address && (\n                        <span className=\"checkout-form-error\">{errors.address}</span>\n                      )}\n                    </div>\n\n                    <div className=\"checkout-form-group\">\n                      <label className=\"checkout-form-label\">\n                        <Home size={18} />\n                        Comuna\n                      </label>\n                      <input\n                        type=\"text\"\n                        name=\"neighborhood\"\n                        value={formData.neighborhood}\n                        onChange={handleInputChange}\n                        onBlur={handleBlur}\n                        className={`checkout-form-input ${errors.neighborhood && touched.neighborhood ? 'error' : ''}`}\n                        placeholder=\"Providencia\"\n                      />\n                      {errors.neighborhood && touched.neighborhood && (\n                        <span className=\"checkout-form-error\">{errors.neighborhood}</span>\n                      )}\n                    </div>\n\n                    <div className=\"checkout-form-group\">\n                      <label className=\"checkout-form-label\">\n                        <MessageSquare size={18} />\n                        Referencias (opcional)\n                      </label>\n                      <input\n                        type=\"text\"\n                        name=\"reference\"\n                        value={formData.reference}\n                        onChange={handleInputChange}\n                        className=\"checkout-form-input\"\n                        placeholder=\"Entre calle A y B, casa azul\"\n                      />\n                      <span className=\"checkout-form-hint\">Ayuda al repartidor a encontrarte</span>\n                    </div>\n                  </>\n                ) : (\n                  <div className=\"checkout-pickup-info\">\n                    <Clock size={48} className=\"checkout-pickup-icon\" />\n                    <h3>Tu pedido estará listo en {storeInfo?.pickupTime || '20-30 minutos'}</h3>\n                    <div className=\"checkout-pickup-details\">\n                      <p><strong>Dirección:</strong> {storeInfo?.address ? \n                        `${storeInfo.address}, ${storeInfo.city}` : \n                        'Cargando dirección...'\n                      }</p>\n                      <p><strong>Horario:</strong> {storeInfo?.schedule ? \n                        Object.entries(storeInfo.schedule).map(([key, value]) => (\n                          <span key={key}>\n                            {value.label}: {value.open} - {value.close}<br />\n                          </span>\n                        )) : \n                        'Cargando horarios...'\n                      }</p>\n                      <p><strong>Teléfono:</strong> {storeInfo?.phone || 'Cargando...'}</p>\n                    </div>\n                    <div className=\"checkout-pickup-note\">\n                      <AlertCircle size={16} />\n                      <p>Te enviaremos un WhatsApp cuando tu pedido esté listo</p>\n                    </div>\n                  </div>\n                )}\n              </div>\n            )}\n\n            {/* Step 3: Pago */}\n            {currentStep === 3 && (\n              <div className=\"checkout-form-section\">\n                <h2 className=\"checkout-section-title\">Método de Pago</h2>\n                \n                <div className=\"checkout-payment-options\">\n                  {paymentMethods.length > 0 ? (\n                    paymentMethods.map((method) => {\n                      const IconComponent = getPaymentIcon(method.id);\n                      const isDisabled = false; // Todos los métodos habilitados desde WooCommerce están disponibles\n                      \n                      return (\n                        <label \n                          key={method.id} \n                          className={`checkout-payment-option ${isDisabled ? 'disabled' : ''}`}\n                        >\n                          <input\n                            type=\"radio\"\n                            name=\"paymentMethod\"\n                            value={method.id}\n                            checked={formData.paymentMethod === method.id}\n                            onChange={handleInputChange}\n                            disabled={isDisabled}\n                          />\n                          <div className=\"checkout-payment-content\">\n                            <IconComponent size={24} />\n                            <div>\n                              <h3>{method.title}</h3>\n                              <p>{method.description || 'Método de pago disponible'}</p>\n                            </div>\n                          </div>\n                        </label>\n                      );\n                    })\n                  ) : (\n                    <div className=\"checkout-no-payment-methods\">\n                      <AlertCircle size={32} />\n                      <p>No hay métodos de pago disponibles</p>\n                    </div>\n                  )}\n\n                  {formData.paymentMethod === 'cod' && (\n                    <div className=\"checkout-cash-amount\">\n                      <label className=\"checkout-form-label\">\n                        ¿Con cuánto pagarás? (opcional)\n                      </label>\n                      <input\n                        type=\"number\"\n                        name=\"cashAmount\"\n                        value={formData.cashAmount}\n                        onChange={handleInputChange}\n                        onBlur={handleBlur}\n                        className={`checkout-form-input ${errors.cashAmount ? 'error' : ''}`}\n                        placeholder={formatPrice(Math.ceil(total / 1000) * 1000)}\n                        min={total}\n                      />\n                      {errors.cashAmount && (\n                        <span className=\"checkout-form-error\">{errors.cashAmount}</span>\n                      )}\n                      <span className=\"checkout-form-hint\">\n                        Para preparar tu vuelto\n                      </span>\n                    </div>\n                  )}\n                </div>\n\n                {errors.paymentMethod && (\n                  <span className=\"checkout-form-error\">{errors.paymentMethod}</span>\n                )}\n\n                <div className=\"checkout-form-group\">\n                  <label className=\"checkout-form-label\">\n                    <MessageSquare size={18} />\n                    Notas adicionales (opcional)\n                  </label>\n                  <textarea\n                    name=\"notes\"\n                    value={formData.notes}\n                    onChange={handleInputChange}\n                    className=\"checkout-form-input checkout-textarea\"\n                    placeholder=\"Ej: Sin cebolla, extra picante, etc.\"\n                    rows={3}\n                  />\n                </div>\n              </div>\n            )}\n          </div>\n\n          {/* Order Summary Sidebar */}\n          <div className=\"checkout-sidebar\">\n            <div className=\"checkout-order-summary\">\n              <button \n                className=\"checkout-summary-toggle\"\n                onClick={() => setShowOrderSummary(!showOrderSummary)}\n              >\n                <h3>Resumen del Pedido</h3>\n                {showOrderSummary ? <ChevronUp size={20} /> : <ChevronDown size={20} />}\n              </button>\n              \n              {showOrderSummary && (\n                <div className=\"checkout-summary-content\">\n                  <div className=\"checkout-summary-items\">\n                    {cart.map(item => (\n                      <div key={item.id} className=\"checkout-summary-item\">\n                        <span>\n                          {item.quantity}x {item.name}\n                        </span>\n                        <span>{formatPrice(item.price * item.quantity)}</span>\n                      </div>\n                    ))}\n                  </div>\n                  \n                  <div className=\"checkout-summary-totals\">\n                    <div className=\"checkout-summary-row\">\n                      <span>Subtotal</span>\n                      <span>{formatPrice(subtotal)}</span>\n                    </div>\n                    {orderType === 'delivery' && (\n                      <div className=\"checkout-summary-row\">\n                        <span>Delivery</span>\n                        <span>{deliveryFee > 0 ? formatPrice(deliveryFee) : 'Envío gratis'}</span>\n                      </div>\n                    )}\n                    <div className=\"checkout-summary-row checkout-summary-total\">\n                      <span>Total</span>\n                      <span>{formatPrice(total)}</span>\n                    </div>\n                  </div>\n                </div>\n              )}\n            </div>\n\n            {/* Action Buttons */}\n            <div className=\"checkout-actions\">\n              {currentStep < 3 ? (\n                <button\n                  onClick={handleNextStep}\n                  className=\"btn btn-primary checkout-continue-btn\"\n                >\n                  Continuar\n                </button>\n              ) : (\n                <button\n                  onClick={handleSubmitOrder}\n                  disabled={loading || !formData.paymentMethod}\n                  className=\"btn btn-primary checkout-confirm-btn\"\n                >\n                  {loading ? 'Procesando...' : 'Confirmar Pedido'}\n                </button>\n              )}\n              \n              <button\n                onClick={() => navigate('/cart')}\n                className=\"btn btn-secondary\"\n              >\n                Volver al carrito\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default CheckoutPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}