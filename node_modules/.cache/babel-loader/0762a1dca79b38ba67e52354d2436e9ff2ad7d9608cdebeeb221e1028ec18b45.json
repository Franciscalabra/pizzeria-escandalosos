{"ast":null,"code":"var _jsxFileName = \"/Users/franciscalabra/Desktop/pizzeria-escandalosos/src/components/CustomizationModal/CustomizationModal.jsx\",\n  _s = $RefreshSig$();\n// src/components/CustomizationModal/CustomizationModal.jsx\nimport React, { useState, useContext, useEffect } from 'react';\nimport { X, Plus, Minus, Info, Check, Loader, Pizza, Upload } from 'lucide-react';\nimport { CartContext } from '../../context/CartContext';\nimport woocommerceApi from '../../services/woocommerceApi';\nimport './CustomizationModal.css';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst CustomizationModal = ({\n  product,\n  isOpen,\n  onClose\n}) => {\n  _s();\n  const {\n    addToCart\n  } = useContext(CartContext);\n\n  // Estados para datos de WooCommerce\n  const [variations, setVariations] = useState([]);\n  const [attributes, setAttributes] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // Estados para Advanced Product Fields\n  const [productAddons, setProductAddons] = useState([]);\n  const [addonValues, setAddonValues] = useState({});\n  const [addonFiles, setAddonFiles] = useState({});\n\n  // Estados de selección\n  const [selectedAttributes, setSelectedAttributes] = useState({});\n  const [selectedVariation, setSelectedVariation] = useState(null);\n  const [quantity, setQuantity] = useState(1);\n  const [specialInstructions, setSpecialInstructions] = useState('');\n  const [totalPrice, setTotalPrice] = useState(0);\n  const [addingToCart, setAddingToCart] = useState(false);\n\n  // Reset estados cuando se abre el modal\n  useEffect(() => {\n    if (isOpen && product) {\n      resetForm();\n      loadProductData();\n    }\n  }, [isOpen, product]);\n\n  // Actualizar precio cuando cambia la selección\n  useEffect(() => {\n    updatePrice();\n  }, [selectedVariation, quantity, product, addonValues]);\n  const resetForm = () => {\n    setSelectedAttributes({});\n    setSelectedVariation(null);\n    setQuantity(1);\n    setSpecialInstructions('');\n    setProductAddons([]);\n    setAddonValues({});\n    setAddonFiles({});\n    setError(null);\n  };\n  const loadProductData = async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      // Debugging: Ver toda la estructura del producto\n      console.log('=== PRODUCTO COMPLETO ===');\n      console.log(product);\n      console.log('=== META DATA ===');\n      console.log(product.meta_data);\n      console.log('=== TODAS LAS PROPIEDADES ===');\n      console.log(Object.keys(product));\n\n      // Si es un producto variable, cargar variaciones\n      if (product.type === 'variable') {\n        const variationsData = await woocommerceApi.getProductVariations(product.id);\n        setVariations(variationsData || []);\n\n        // Extraer atributos del producto\n        if (product.attributes) {\n          const variableAttributes = product.attributes.filter(attr => attr.variation);\n          setAttributes(variableAttributes);\n\n          // Establecer valores por defecto\n          const defaultAttributes = {};\n          variableAttributes.forEach(attr => {\n            if (attr.options && attr.options.length > 0) {\n              defaultAttributes[attr.name] = attr.options[0];\n            }\n          });\n          setSelectedAttributes(defaultAttributes);\n\n          // Buscar variación por defecto\n          findMatchingVariation(defaultAttributes);\n        }\n      } else {\n        // Para productos simples, establecer el precio directamente\n        setTotalPrice(parseFloat(product.price) * quantity);\n      }\n\n      // Cargar Advanced Product Fields si existen\n      loadProductAddons();\n    } catch (err) {\n      console.error('Error loading product data:', err);\n      setError('Error al cargar las opciones del producto. Por favor, intenta de nuevo.');\n    } finally {\n      setLoading(false);\n    }\n  };\n  const loadProductAddons = () => {\n    console.log('=== BUSCANDO ADDONS ===');\n\n    // Verificar si el producto tiene campos adicionales del plugin Advanced Product Fields\n    if (product.meta_data) {\n      console.log('Meta data encontrada:', product.meta_data);\n\n      // Buscar diferentes posibles keys donde el plugin podría guardar los campos\n      const possibleKeys = ['_product_addons', 'product_addons', '_wapf_fieldgroup', '_wapf_field_groups', 'wapf_field_groups', 'advanced_product_fields', '_advanced_product_fields', 'product_fields', '_product_fields'];\n      let addonsFound = false;\n      possibleKeys.forEach(key => {\n        const addonsData = product.meta_data.find(meta => meta.key === key);\n        if (addonsData) {\n          console.log(`Addons encontrados con key \"${key}\":`, addonsData);\n          addonsFound = true;\n\n          // Procesar los campos adicionales\n          const fields = Array.isArray(addonsData.value) ? addonsData.value : [addonsData.value];\n          setProductAddons(fields);\n\n          // Inicializar valores por defecto\n          const defaultValues = {};\n          fields.forEach(field => {\n            if (field.type === 'checkbox') {\n              defaultValues[field.id || field.name] = [];\n            } else if (field.type === 'number' && field.min) {\n              defaultValues[field.id || field.name] = field.min;\n            } else {\n              defaultValues[field.id || field.name] = '';\n            }\n          });\n          setAddonValues(defaultValues);\n        }\n      });\n      if (!addonsFound) {\n        console.log('No se encontraron addons en meta_data con las keys conocidas');\n      }\n    }\n\n    // También verificar si hay campos en el objeto addons del producto\n    if (product.addons) {\n      console.log('Addons encontrados directamente en product.addons:', product.addons);\n      setProductAddons(product.addons);\n\n      // Inicializar valores por defecto\n      const defaultValues = {};\n      product.addons.forEach(field => {\n        if (field.type === 'checkbox' || field.type === 'multiple_choice') {\n          defaultValues[field.id || field.name] = [];\n        } else if (field.type === 'number' && field.min !== undefined) {\n          defaultValues[field.id || field.name] = field.min;\n        } else {\n          defaultValues[field.id || field.name] = '';\n        }\n      });\n      setAddonValues(defaultValues);\n    }\n\n    // Verificar campos personalizados de ACF o campos custom\n    if (product.acf) {\n      console.log('ACF fields encontrados:', product.acf);\n    }\n\n    // Log final\n    console.log('=== ESTADO FINAL DE ADDONS ===');\n    console.log('productAddons:', productAddons);\n  };\n  const handleAttributeChange = (attributeName, value) => {\n    const newAttributes = {\n      ...selectedAttributes,\n      [attributeName]: value\n    };\n    setSelectedAttributes(newAttributes);\n\n    // Buscar variación que coincida con los atributos seleccionados\n    findMatchingVariation(newAttributes);\n  };\n  const findMatchingVariation = attributes => {\n    if (!variations || variations.length === 0) return;\n    const matching = variations.find(variation => {\n      return variation.attributes.every(attr => {\n        const normalizedAttrName = attr.name.toLowerCase().replace(/-/g, ' ');\n        const selectedValue = attributes[attr.name] || attributes[normalizedAttrName];\n        return selectedValue === attr.option;\n      });\n    });\n    setSelectedVariation(matching || null);\n  };\n  const handleAddonChange = (fieldId, value) => {\n    setAddonValues(prev => ({\n      ...prev,\n      [fieldId]: value\n    }));\n  };\n  const handleFileUpload = (fieldId, file) => {\n    if (file) {\n      setAddonFiles(prev => ({\n        ...prev,\n        [fieldId]: file\n      }));\n      setAddonValues(prev => ({\n        ...prev,\n        [fieldId]: file.name\n      }));\n    }\n  };\n  const calculateAddonPrice = () => {\n    let addonTotal = 0;\n    productAddons.forEach(addon => {\n      const fieldId = addon.id || addon.name;\n      const value = addonValues[fieldId];\n      if (!value || Array.isArray(value) && value.length === 0) return;\n\n      // Precio fijo\n      if (addon.price_type === 'flat_fee' && addon.price) {\n        addonTotal += parseFloat(addon.price);\n      }\n\n      // Precio basado en cantidad\n      else if (addon.price_type === 'quantity_based' && addon.price) {\n        addonTotal += parseFloat(addon.price) * quantity;\n      }\n\n      // Precio por carácter (para campos de texto)\n      else if (addon.price_type === 'per_char' && addon.price && typeof value === 'string') {\n        addonTotal += parseFloat(addon.price) * value.length;\n      }\n\n      // Para campos con opciones (radio, select, checkbox)\n      else if (addon.options && Array.isArray(addon.options)) {\n        addon.options.forEach(option => {\n          const isSelected = Array.isArray(value) ? value.includes(option.label || option.value) : value === (option.label || option.value);\n          if (isSelected && option.price) {\n            if (option.price_type === 'quantity_based') {\n              addonTotal += parseFloat(option.price) * quantity;\n            } else {\n              addonTotal += parseFloat(option.price);\n            }\n          }\n        });\n      }\n    });\n    return addonTotal;\n  };\n  const updatePrice = () => {\n    let basePrice = 0;\n    if (selectedVariation && selectedVariation.price) {\n      basePrice = parseFloat(selectedVariation.price);\n    } else if (product && product.price) {\n      basePrice = parseFloat(product.price);\n    }\n    const addonPrice = calculateAddonPrice();\n    setTotalPrice((basePrice + addonPrice) * quantity);\n  };\n  const formatPrice = price => {\n    return new Intl.NumberFormat('es-CL', {\n      style: 'currency',\n      currency: 'CLP',\n      minimumFractionDigits: 0,\n      maximumFractionDigits: 0\n    }).format(price);\n  };\n  const isValidSelection = () => {\n    if (product.type === 'variable') {\n      // Para productos variables, verificar que se haya seleccionado una variación válida\n      if (!selectedVariation || selectedVariation.stock_status === 'outofstock') {\n        return false;\n      }\n    }\n\n    // Validar campos requeridos de Advanced Product Fields\n    for (const addon of productAddons) {\n      if (addon.required) {\n        const fieldId = addon.id || addon.name;\n        const value = addonValues[fieldId];\n        if (!value || Array.isArray(value) && value.length === 0) {\n          setError(`Por favor, completa el campo: ${addon.title || addon.name}`);\n          return false;\n        }\n      }\n    }\n    return true;\n  };\n  const handleAddToCart = async () => {\n    if (!isValidSelection()) {\n      if (!error) {\n        setError('Por favor, selecciona todas las opciones requeridas');\n      }\n      return;\n    }\n    setAddingToCart(true);\n    try {\n      var _selectedVariation$im, _product$images, _product$images$;\n      // Preparar meta_data para Advanced Product Fields\n      const addonMetaData = [];\n      productAddons.forEach(addon => {\n        const fieldId = addon.id || addon.name;\n        const value = addonValues[fieldId];\n        if (value && !(Array.isArray(value) && value.length === 0)) {\n          // Agregar el campo a meta_data\n          addonMetaData.push({\n            key: addon.name || addon.title,\n            value: Array.isArray(value) ? value.join(', ') : value,\n            display: addon.title || addon.name,\n            price: addon.price || 0,\n            price_type: addon.price_type || 'flat_fee'\n          });\n        }\n      });\n      const cartItem = {\n        id: selectedVariation ? `${product.id}-${selectedVariation.id}-${Date.now()}` : `${product.id}-${Date.now()}`,\n        productId: product.id,\n        variationId: selectedVariation === null || selectedVariation === void 0 ? void 0 : selectedVariation.id,\n        name: product.name,\n        price: totalPrice / quantity,\n        // Precio unitario incluyendo addons\n        image: (selectedVariation === null || selectedVariation === void 0 ? void 0 : (_selectedVariation$im = selectedVariation.image) === null || _selectedVariation$im === void 0 ? void 0 : _selectedVariation$im.src) || ((_product$images = product.images) === null || _product$images === void 0 ? void 0 : (_product$images$ = _product$images[0]) === null || _product$images$ === void 0 ? void 0 : _product$images$.src) || '',\n        quantity,\n        customizations: {\n          attributes: selectedAttributes,\n          specialInstructions: specialInstructions.trim(),\n          variationDetails: selectedVariation ? {\n            name: selectedVariation.name,\n            attributes: selectedVariation.attributes\n          } : null,\n          // Agregar datos de Advanced Product Fields\n          productAddons: addonMetaData,\n          addonValues: addonValues,\n          addonFiles: Object.keys(addonFiles).length > 0 ? addonFiles : null\n        }\n      };\n      addToCart(cartItem);\n\n      // Mostrar mensaje de éxito\n      setTimeout(() => {\n        onClose();\n        resetForm();\n      }, 500);\n    } catch (err) {\n      setError('Error al agregar al carrito. Por favor, intenta de nuevo.');\n    } finally {\n      setAddingToCart(false);\n    }\n  };\n  const renderAddonField = addon => {\n    var _addon$options, _addon$options2, _addon$options3;\n    const fieldId = addon.id || addon.name;\n    const value = addonValues[fieldId] || '';\n    switch (addon.type) {\n      case 'text':\n      case 'custom_text':\n        return /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          value: value,\n          onChange: e => handleAddonChange(fieldId, e.target.value),\n          placeholder: addon.placeholder || '',\n          maxLength: addon.max || undefined,\n          className: \"addon-text-input\",\n          required: addon.required\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 397,\n          columnNumber: 11\n        }, this);\n      case 'textarea':\n      case 'custom_textarea':\n        return /*#__PURE__*/_jsxDEV(\"textarea\", {\n          value: value,\n          onChange: e => handleAddonChange(fieldId, e.target.value),\n          placeholder: addon.placeholder || '',\n          maxLength: addon.max || undefined,\n          rows: 4,\n          className: \"addon-textarea\",\n          required: addon.required\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 411,\n          columnNumber: 11\n        }, this);\n      case 'number':\n        return /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"number\",\n          value: value,\n          onChange: e => handleAddonChange(fieldId, parseFloat(e.target.value) || 0),\n          min: addon.min || undefined,\n          max: addon.max || undefined,\n          step: addon.step || 1,\n          className: \"addon-number-input\",\n          required: addon.required\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 424,\n          columnNumber: 11\n        }, this);\n      case 'email':\n        return /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"email\",\n          value: value,\n          onChange: e => handleAddonChange(fieldId, e.target.value),\n          placeholder: addon.placeholder || 'email@ejemplo.com',\n          className: \"addon-email-input\",\n          required: addon.required\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 438,\n          columnNumber: 11\n        }, this);\n      case 'select':\n      case 'dropdown':\n        return /*#__PURE__*/_jsxDEV(\"select\", {\n          value: value,\n          onChange: e => handleAddonChange(fieldId, e.target.value),\n          className: \"addon-select\",\n          required: addon.required,\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"\",\n            children: \"Selecciona una opci\\xF3n\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 457,\n            columnNumber: 13\n          }, this), (_addon$options = addon.options) === null || _addon$options === void 0 ? void 0 : _addon$options.map((option, index) => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: option.label || option.value,\n            children: [option.label || option.value, option.price && option.price > 0 && ` (+${formatPrice(option.price)})`]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 459,\n            columnNumber: 15\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 451,\n          columnNumber: 11\n        }, this);\n      case 'radio':\n      case 'radiobutton':\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"addon-radio-group\",\n          children: (_addon$options2 = addon.options) === null || _addon$options2 === void 0 ? void 0 : _addon$options2.map((option, index) => /*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"addon-radio-option\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"radio\",\n              name: fieldId,\n              value: option.label || option.value,\n              checked: value === (option.label || option.value),\n              onChange: e => handleAddonChange(fieldId, e.target.value),\n              required: addon.required\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 473,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"radio-label\",\n              children: [option.label || option.value, option.price && option.price > 0 && ` (+${formatPrice(option.price)})`]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 481,\n              columnNumber: 17\n            }, this)]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 472,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 470,\n          columnNumber: 11\n        }, this);\n      case 'checkbox':\n      case 'multiple_choice':\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"addon-checkbox-group\",\n          children: (_addon$options3 = addon.options) === null || _addon$options3 === void 0 ? void 0 : _addon$options3.map((option, index) => /*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"addon-checkbox-option\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"checkbox\",\n              value: option.label || option.value,\n              checked: Array.isArray(value) && value.includes(option.label || option.value),\n              onChange: e => {\n                const optionValue = option.label || option.value;\n                const currentValues = Array.isArray(value) ? value : [];\n                if (e.target.checked) {\n                  handleAddonChange(fieldId, [...currentValues, optionValue]);\n                } else {\n                  handleAddonChange(fieldId, currentValues.filter(v => v !== optionValue));\n                }\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 496,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"checkbox-label\",\n              children: [option.label || option.value, option.price && option.price > 0 && ` (+${formatPrice(option.price)})`]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 511,\n              columnNumber: 17\n            }, this)]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 495,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 493,\n          columnNumber: 11\n        }, this);\n      case 'file':\n      case 'file_upload':\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"addon-file-upload\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"file-upload-label\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"file\",\n              onChange: e => handleFileUpload(fieldId, e.target.files[0]),\n              accept: addon.allowed_types || '*',\n              required: addon.required,\n              className: \"file-input\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 525,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"file-upload-button\",\n              children: [/*#__PURE__*/_jsxDEV(Upload, {\n                size: 16\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 533,\n                columnNumber: 17\n              }, this), addonFiles[fieldId] ? addonFiles[fieldId].name : 'Seleccionar archivo']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 532,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 524,\n            columnNumber: 13\n          }, this), addon.max_size && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"file-size-info\",\n            children: [\"Tama\\xF1o m\\xE1ximo: \", addon.max_size, \"MB\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 538,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 523,\n          columnNumber: 11\n        }, this);\n      case 'date':\n      case 'date_picker':\n        return /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"date\",\n          value: value,\n          onChange: e => handleAddonChange(fieldId, e.target.value),\n          min: addon.min_date || undefined,\n          max: addon.max_date || undefined,\n          className: \"addon-date-input\",\n          required: addon.required\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 546,\n          columnNumber: 11\n        }, this);\n      case 'color':\n      case 'color_picker':\n        return /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"color\",\n          value: value || '#000000',\n          onChange: e => handleAddonChange(fieldId, e.target.value),\n          className: \"addon-color-input\",\n          required: addon.required\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 560,\n          columnNumber: 11\n        }, this);\n      case 'true_false':\n        return /*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"addon-checkbox-option\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            checked: value === true || value === 'yes',\n            onChange: e => handleAddonChange(fieldId, e.target.checked),\n            required: addon.required\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 572,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"checkbox-label\",\n            children: addon.label || 'Sí'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 578,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 571,\n          columnNumber: 11\n        }, this);\n      default:\n        return null;\n    }\n  };\n  if (!isOpen || !product) return null;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"customization-modal-overlay\",\n    onClick: onClose,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"customization-modal\",\n      onClick: e => e.stopPropagation(),\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"close-button\",\n        onClick: onClose,\n        children: /*#__PURE__*/_jsxDEV(X, {\n          size: 24\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 595,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 594,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n        children: [\"Personaliza tu \", product.name]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 598,\n        columnNumber: 9\n      }, this), loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"loading-container\",\n        children: [/*#__PURE__*/_jsxDEV(Loader, {\n          className: \"loading-spinner\",\n          size: 48\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 602,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Cargando opciones...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 603,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 601,\n        columnNumber: 11\n      }, this) : error ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"error-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"error-message\",\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 607,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: loadProductData,\n          className: \"retry-button\",\n          children: \"Reintentar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 608,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 606,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"customization-product-info\",\n          children: [product.images && product.images[0] ? /*#__PURE__*/_jsxDEV(\"img\", {\n            src: product.images[0].src,\n            alt: product.name,\n            className: \"customization-product-image\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 617,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"customization-product-image placeholder\",\n            children: /*#__PURE__*/_jsxDEV(Pizza, {\n              size: 48\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 624,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 623,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"product-details\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              children: product.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 628,\n              columnNumber: 17\n            }, this), product.short_description && /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"product-description\",\n              dangerouslySetInnerHTML: {\n                __html: product.short_description\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 630,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 627,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 615,\n          columnNumber: 13\n        }, this), attributes.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"customization-section\",\n          children: attributes.map(attribute => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"attribute-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: attribute.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 641,\n              columnNumber: 21\n            }, this), attribute.description && /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"section-description\",\n              children: attribute.description\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 643,\n              columnNumber: 23\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"attribute-options\",\n              children: attribute.options.map(option => /*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"attribute-option\",\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"radio\",\n                  name: attribute.name,\n                  value: option,\n                  checked: selectedAttributes[attribute.name] === option,\n                  onChange: () => handleAttributeChange(attribute.name, option)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 648,\n                  columnNumber: 27\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"option-label\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"option-check\",\n                    children: /*#__PURE__*/_jsxDEV(Check, {\n                      size: 16\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 657,\n                      columnNumber: 31\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 656,\n                    columnNumber: 29\n                  }, this), option]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 655,\n                  columnNumber: 27\n                }, this)]\n              }, option, true, {\n                fileName: _jsxFileName,\n                lineNumber: 647,\n                columnNumber: 25\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 645,\n              columnNumber: 21\n            }, this)]\n          }, attribute.id || attribute.name, true, {\n            fileName: _jsxFileName,\n            lineNumber: 640,\n            columnNumber: 19\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 638,\n          columnNumber: 15\n        }, this), productAddons.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"customization-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: \"Opciones adicionales\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 672,\n            columnNumber: 17\n          }, this), productAddons.map((addon, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"addon-field\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"addon-label\",\n              children: [addon.title || addon.name, addon.required && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"required\",\n                children: \"*\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 677,\n                columnNumber: 42\n              }, this), addon.price && addon.price > 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"addon-price\",\n                children: addon.price_type === 'quantity_based' ? ` (+${formatPrice(addon.price)} por unidad)` : ` (+${formatPrice(addon.price)})`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 679,\n                columnNumber: 25\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 675,\n              columnNumber: 21\n            }, this), addon.description && /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"addon-description\",\n              children: addon.description\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 688,\n              columnNumber: 23\n            }, this), renderAddonField(addon)]\n          }, addon.id || addon.name || index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 674,\n            columnNumber: 19\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 671,\n          columnNumber: 15\n        }, this), selectedVariation && (selectedVariation.stock_status === 'outofstock' || selectedVariation.stock_quantity && selectedVariation.stock_quantity < 10) && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"variation-info\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"variation-details\",\n            children: selectedVariation.stock_status === 'outofstock' ? /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"out-of-stock\",\n              children: \"\\u26A0\\uFE0F Producto agotado\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 702,\n              columnNumber: 21\n            }, this) : selectedVariation.stock_quantity && selectedVariation.stock_quantity < 10 ? /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"low-stock\",\n              children: [\"\\u26A1 \\xDAltimas \", selectedVariation.stock_quantity, \" unidades\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 704,\n              columnNumber: 21\n            }, this) : null\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 700,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 699,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"customization-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: \"Instrucciones especiales (opcional)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 712,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"section-description\",\n            children: \"\\xBFAlguna preferencia especial?\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 713,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n            className: \"special-instructions\",\n            value: specialInstructions,\n            onChange: e => setSpecialInstructions(e.target.value),\n            placeholder: \"Ej: Sin cebolla, extra queso, etc.\",\n            maxLength: 200\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 716,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"char-count\",\n            children: [specialInstructions.length, \"/200\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 723,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 711,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"customization-section quantity-controls\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"quantity-selector\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"quantity-btn\",\n              onClick: () => setQuantity(Math.max(1, quantity - 1)),\n              disabled: quantity <= 1,\n              children: /*#__PURE__*/_jsxDEV(Minus, {\n                size: 16\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 736,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 731,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"quantity-value\",\n              children: quantity\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 738,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"quantity-btn\",\n              onClick: () => setQuantity(quantity + 1),\n              disabled: selectedVariation && selectedVariation.stock_quantity && quantity >= selectedVariation.stock_quantity,\n              children: /*#__PURE__*/_jsxDEV(Plus, {\n                size: 16\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 745,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 739,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 730,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"quantity-price\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"price-label\",\n              children: \"Precio unitario\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 749,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"price-value\",\n              children: formatPrice(totalPrice / quantity)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 750,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 748,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 729,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"customization-footer\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"total-info\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"total-label\",\n            children: \"Total\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 759,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"total-price\",\n            children: formatPrice(totalPrice)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 760,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 758,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: `add-to-cart-btn ${addingToCart ? 'adding' : ''}`,\n          onClick: handleAddToCart,\n          disabled: loading || addingToCart || selectedVariation && selectedVariation.stock_status === 'outofstock',\n          children: addingToCart ? /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(Loader, {\n              className: \"btn-spinner\",\n              size: 20\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 770,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Agregando...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 771,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(Check, {\n              className: \"btn-icon\",\n              size: 20\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 775,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Agregar al carrito\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 776,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 762,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 757,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 593,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 592,\n    columnNumber: 5\n  }, this);\n};\n_s(CustomizationModal, \"4XaR/Sq9+ME7045Ck6oUWYvYuN0=\");\n_c = CustomizationModal;\nexport default CustomizationModal;\nvar _c;\n$RefreshReg$(_c, \"CustomizationModal\");","map":{"version":3,"names":["React","useState","useContext","useEffect","X","Plus","Minus","Info","Check","Loader","Pizza","Upload","CartContext","woocommerceApi","jsxDEV","_jsxDEV","Fragment","_Fragment","CustomizationModal","product","isOpen","onClose","_s","addToCart","variations","setVariations","attributes","setAttributes","loading","setLoading","error","setError","productAddons","setProductAddons","addonValues","setAddonValues","addonFiles","setAddonFiles","selectedAttributes","setSelectedAttributes","selectedVariation","setSelectedVariation","quantity","setQuantity","specialInstructions","setSpecialInstructions","totalPrice","setTotalPrice","addingToCart","setAddingToCart","resetForm","loadProductData","updatePrice","console","log","meta_data","Object","keys","type","variationsData","getProductVariations","id","variableAttributes","filter","attr","variation","defaultAttributes","forEach","options","length","name","findMatchingVariation","parseFloat","price","loadProductAddons","err","possibleKeys","addonsFound","key","addonsData","find","meta","fields","Array","isArray","value","defaultValues","field","min","addons","undefined","acf","handleAttributeChange","attributeName","newAttributes","matching","every","normalizedAttrName","toLowerCase","replace","selectedValue","option","handleAddonChange","fieldId","prev","handleFileUpload","file","calculateAddonPrice","addonTotal","addon","price_type","isSelected","includes","label","basePrice","addonPrice","formatPrice","Intl","NumberFormat","style","currency","minimumFractionDigits","maximumFractionDigits","format","isValidSelection","stock_status","required","title","handleAddToCart","_selectedVariation$im","_product$images","_product$images$","addonMetaData","push","join","display","cartItem","Date","now","productId","variationId","image","src","images","customizations","trim","variationDetails","setTimeout","renderAddonField","_addon$options","_addon$options2","_addon$options3","onChange","e","target","placeholder","maxLength","max","className","fileName","_jsxFileName","lineNumber","columnNumber","rows","step","children","map","index","checked","optionValue","currentValues","v","files","accept","allowed_types","size","max_size","min_date","max_date","onClick","stopPropagation","alt","short_description","dangerouslySetInnerHTML","__html","attribute","description","stock_quantity","Math","disabled","_c","$RefreshReg$"],"sources":["/Users/franciscalabra/Desktop/pizzeria-escandalosos/src/components/CustomizationModal/CustomizationModal.jsx"],"sourcesContent":["// src/components/CustomizationModal/CustomizationModal.jsx\nimport React, { useState, useContext, useEffect } from 'react';\nimport { X, Plus, Minus, Info, Check, Loader, Pizza, Upload } from 'lucide-react';\nimport { CartContext } from '../../context/CartContext';\nimport woocommerceApi from '../../services/woocommerceApi';\nimport './CustomizationModal.css';\n\nconst CustomizationModal = ({ product, isOpen, onClose }) => {\n  const { addToCart } = useContext(CartContext);\n  \n  // Estados para datos de WooCommerce\n  const [variations, setVariations] = useState([]);\n  const [attributes, setAttributes] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  \n  // Estados para Advanced Product Fields\n  const [productAddons, setProductAddons] = useState([]);\n  const [addonValues, setAddonValues] = useState({});\n  const [addonFiles, setAddonFiles] = useState({});\n  \n  // Estados de selección\n  const [selectedAttributes, setSelectedAttributes] = useState({});\n  const [selectedVariation, setSelectedVariation] = useState(null);\n  const [quantity, setQuantity] = useState(1);\n  const [specialInstructions, setSpecialInstructions] = useState('');\n  const [totalPrice, setTotalPrice] = useState(0);\n  const [addingToCart, setAddingToCart] = useState(false);\n\n  // Reset estados cuando se abre el modal\n  useEffect(() => {\n    if (isOpen && product) {\n      resetForm();\n      loadProductData();\n    }\n  }, [isOpen, product]);\n\n  // Actualizar precio cuando cambia la selección\n  useEffect(() => {\n    updatePrice();\n  }, [selectedVariation, quantity, product, addonValues]);\n\n  const resetForm = () => {\n    setSelectedAttributes({});\n    setSelectedVariation(null);\n    setQuantity(1);\n    setSpecialInstructions('');\n    setProductAddons([]);\n    setAddonValues({});\n    setAddonFiles({});\n    setError(null);\n  };\n\n  const loadProductData = async () => {\n    setLoading(true);\n    setError(null);\n    \n    try {\n      // Debugging: Ver toda la estructura del producto\n      console.log('=== PRODUCTO COMPLETO ===');\n      console.log(product);\n      console.log('=== META DATA ===');\n      console.log(product.meta_data);\n      console.log('=== TODAS LAS PROPIEDADES ===');\n      console.log(Object.keys(product));\n      \n      // Si es un producto variable, cargar variaciones\n      if (product.type === 'variable') {\n        const variationsData = await woocommerceApi.getProductVariations(product.id);\n        setVariations(variationsData || []);\n        \n        // Extraer atributos del producto\n        if (product.attributes) {\n          const variableAttributes = product.attributes.filter(attr => attr.variation);\n          setAttributes(variableAttributes);\n          \n          // Establecer valores por defecto\n          const defaultAttributes = {};\n          variableAttributes.forEach(attr => {\n            if (attr.options && attr.options.length > 0) {\n              defaultAttributes[attr.name] = attr.options[0];\n            }\n          });\n          setSelectedAttributes(defaultAttributes);\n          \n          // Buscar variación por defecto\n          findMatchingVariation(defaultAttributes);\n        }\n      } else {\n        // Para productos simples, establecer el precio directamente\n        setTotalPrice(parseFloat(product.price) * quantity);\n      }\n\n      // Cargar Advanced Product Fields si existen\n      loadProductAddons();\n      \n    } catch (err) {\n      console.error('Error loading product data:', err);\n      setError('Error al cargar las opciones del producto. Por favor, intenta de nuevo.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadProductAddons = () => {\n    console.log('=== BUSCANDO ADDONS ===');\n    \n    // Verificar si el producto tiene campos adicionales del plugin Advanced Product Fields\n    if (product.meta_data) {\n      console.log('Meta data encontrada:', product.meta_data);\n      \n      // Buscar diferentes posibles keys donde el plugin podría guardar los campos\n      const possibleKeys = [\n        '_product_addons',\n        'product_addons',\n        '_wapf_fieldgroup',\n        '_wapf_field_groups',\n        'wapf_field_groups',\n        'advanced_product_fields',\n        '_advanced_product_fields',\n        'product_fields',\n        '_product_fields'\n      ];\n      \n      let addonsFound = false;\n      \n      possibleKeys.forEach(key => {\n        const addonsData = product.meta_data.find(meta => meta.key === key);\n        if (addonsData) {\n          console.log(`Addons encontrados con key \"${key}\":`, addonsData);\n          addonsFound = true;\n          \n          // Procesar los campos adicionales\n          const fields = Array.isArray(addonsData.value) ? addonsData.value : [addonsData.value];\n          setProductAddons(fields);\n          \n          // Inicializar valores por defecto\n          const defaultValues = {};\n          fields.forEach(field => {\n            if (field.type === 'checkbox') {\n              defaultValues[field.id || field.name] = [];\n            } else if (field.type === 'number' && field.min) {\n              defaultValues[field.id || field.name] = field.min;\n            } else {\n              defaultValues[field.id || field.name] = '';\n            }\n          });\n          setAddonValues(defaultValues);\n        }\n      });\n      \n      if (!addonsFound) {\n        console.log('No se encontraron addons en meta_data con las keys conocidas');\n      }\n    }\n\n    // También verificar si hay campos en el objeto addons del producto\n    if (product.addons) {\n      console.log('Addons encontrados directamente en product.addons:', product.addons);\n      setProductAddons(product.addons);\n      \n      // Inicializar valores por defecto\n      const defaultValues = {};\n      product.addons.forEach(field => {\n        if (field.type === 'checkbox' || field.type === 'multiple_choice') {\n          defaultValues[field.id || field.name] = [];\n        } else if (field.type === 'number' && field.min !== undefined) {\n          defaultValues[field.id || field.name] = field.min;\n        } else {\n          defaultValues[field.id || field.name] = '';\n        }\n      });\n      setAddonValues(defaultValues);\n    }\n    \n    // Verificar campos personalizados de ACF o campos custom\n    if (product.acf) {\n      console.log('ACF fields encontrados:', product.acf);\n    }\n    \n    // Log final\n    console.log('=== ESTADO FINAL DE ADDONS ===');\n    console.log('productAddons:', productAddons);\n  };\n\n  const handleAttributeChange = (attributeName, value) => {\n    const newAttributes = {\n      ...selectedAttributes,\n      [attributeName]: value\n    };\n    setSelectedAttributes(newAttributes);\n    \n    // Buscar variación que coincida con los atributos seleccionados\n    findMatchingVariation(newAttributes);\n  };\n\n  const findMatchingVariation = (attributes) => {\n    if (!variations || variations.length === 0) return;\n    \n    const matching = variations.find(variation => {\n      return variation.attributes.every(attr => {\n        const normalizedAttrName = attr.name.toLowerCase().replace(/-/g, ' ');\n        const selectedValue = attributes[attr.name] || attributes[normalizedAttrName];\n        return selectedValue === attr.option;\n      });\n    });\n    \n    setSelectedVariation(matching || null);\n  };\n\n  const handleAddonChange = (fieldId, value) => {\n    setAddonValues(prev => ({\n      ...prev,\n      [fieldId]: value\n    }));\n  };\n\n  const handleFileUpload = (fieldId, file) => {\n    if (file) {\n      setAddonFiles(prev => ({\n        ...prev,\n        [fieldId]: file\n      }));\n      setAddonValues(prev => ({\n        ...prev,\n        [fieldId]: file.name\n      }));\n    }\n  };\n\n  const calculateAddonPrice = () => {\n    let addonTotal = 0;\n    \n    productAddons.forEach(addon => {\n      const fieldId = addon.id || addon.name;\n      const value = addonValues[fieldId];\n      \n      if (!value || (Array.isArray(value) && value.length === 0)) return;\n      \n      // Precio fijo\n      if (addon.price_type === 'flat_fee' && addon.price) {\n        addonTotal += parseFloat(addon.price);\n      }\n      \n      // Precio basado en cantidad\n      else if (addon.price_type === 'quantity_based' && addon.price) {\n        addonTotal += parseFloat(addon.price) * quantity;\n      }\n      \n      // Precio por carácter (para campos de texto)\n      else if (addon.price_type === 'per_char' && addon.price && typeof value === 'string') {\n        addonTotal += parseFloat(addon.price) * value.length;\n      }\n      \n      // Para campos con opciones (radio, select, checkbox)\n      else if (addon.options && Array.isArray(addon.options)) {\n        addon.options.forEach(option => {\n          const isSelected = Array.isArray(value) \n            ? value.includes(option.label || option.value)\n            : value === (option.label || option.value);\n            \n          if (isSelected && option.price) {\n            if (option.price_type === 'quantity_based') {\n              addonTotal += parseFloat(option.price) * quantity;\n            } else {\n              addonTotal += parseFloat(option.price);\n            }\n          }\n        });\n      }\n    });\n    \n    return addonTotal;\n  };\n\n  const updatePrice = () => {\n    let basePrice = 0;\n    \n    if (selectedVariation && selectedVariation.price) {\n      basePrice = parseFloat(selectedVariation.price);\n    } else if (product && product.price) {\n      basePrice = parseFloat(product.price);\n    }\n    \n    const addonPrice = calculateAddonPrice();\n    setTotalPrice((basePrice + addonPrice) * quantity);\n  };\n\n  const formatPrice = (price) => {\n    return new Intl.NumberFormat('es-CL', {\n      style: 'currency',\n      currency: 'CLP',\n      minimumFractionDigits: 0,\n      maximumFractionDigits: 0,\n    }).format(price);\n  };\n\n  const isValidSelection = () => {\n    if (product.type === 'variable') {\n      // Para productos variables, verificar que se haya seleccionado una variación válida\n      if (!selectedVariation || selectedVariation.stock_status === 'outofstock') {\n        return false;\n      }\n    }\n    \n    // Validar campos requeridos de Advanced Product Fields\n    for (const addon of productAddons) {\n      if (addon.required) {\n        const fieldId = addon.id || addon.name;\n        const value = addonValues[fieldId];\n        \n        if (!value || (Array.isArray(value) && value.length === 0)) {\n          setError(`Por favor, completa el campo: ${addon.title || addon.name}`);\n          return false;\n        }\n      }\n    }\n    \n    return true;\n  };\n\n  const handleAddToCart = async () => {\n    if (!isValidSelection()) {\n      if (!error) {\n        setError('Por favor, selecciona todas las opciones requeridas');\n      }\n      return;\n    }\n\n    setAddingToCart(true);\n\n    try {\n      // Preparar meta_data para Advanced Product Fields\n      const addonMetaData = [];\n      \n      productAddons.forEach(addon => {\n        const fieldId = addon.id || addon.name;\n        const value = addonValues[fieldId];\n        \n        if (value && !(Array.isArray(value) && value.length === 0)) {\n          // Agregar el campo a meta_data\n          addonMetaData.push({\n            key: addon.name || addon.title,\n            value: Array.isArray(value) ? value.join(', ') : value,\n            display: addon.title || addon.name,\n            price: addon.price || 0,\n            price_type: addon.price_type || 'flat_fee'\n          });\n        }\n      });\n\n      const cartItem = {\n        id: selectedVariation ? `${product.id}-${selectedVariation.id}-${Date.now()}` : `${product.id}-${Date.now()}`,\n        productId: product.id,\n        variationId: selectedVariation?.id,\n        name: product.name,\n        price: totalPrice / quantity, // Precio unitario incluyendo addons\n        image: selectedVariation?.image?.src || product.images?.[0]?.src || '',\n        quantity,\n        customizations: {\n          attributes: selectedAttributes,\n          specialInstructions: specialInstructions.trim(),\n          variationDetails: selectedVariation ? {\n            name: selectedVariation.name,\n            attributes: selectedVariation.attributes\n          } : null,\n          // Agregar datos de Advanced Product Fields\n          productAddons: addonMetaData,\n          addonValues: addonValues,\n          addonFiles: Object.keys(addonFiles).length > 0 ? addonFiles : null\n        }\n      };\n\n      addToCart(cartItem);\n      \n      // Mostrar mensaje de éxito\n      setTimeout(() => {\n        onClose();\n        resetForm();\n      }, 500);\n      \n    } catch (err) {\n      setError('Error al agregar al carrito. Por favor, intenta de nuevo.');\n    } finally {\n      setAddingToCart(false);\n    }\n  };\n\n  const renderAddonField = (addon) => {\n    const fieldId = addon.id || addon.name;\n    const value = addonValues[fieldId] || '';\n    \n    switch (addon.type) {\n      case 'text':\n      case 'custom_text':\n        return (\n          <input\n            type=\"text\"\n            value={value}\n            onChange={(e) => handleAddonChange(fieldId, e.target.value)}\n            placeholder={addon.placeholder || ''}\n            maxLength={addon.max || undefined}\n            className=\"addon-text-input\"\n            required={addon.required}\n          />\n        );\n        \n      case 'textarea':\n      case 'custom_textarea':\n        return (\n          <textarea\n            value={value}\n            onChange={(e) => handleAddonChange(fieldId, e.target.value)}\n            placeholder={addon.placeholder || ''}\n            maxLength={addon.max || undefined}\n            rows={4}\n            className=\"addon-textarea\"\n            required={addon.required}\n          />\n        );\n        \n      case 'number':\n        return (\n          <input\n            type=\"number\"\n            value={value}\n            onChange={(e) => handleAddonChange(fieldId, parseFloat(e.target.value) || 0)}\n            min={addon.min || undefined}\n            max={addon.max || undefined}\n            step={addon.step || 1}\n            className=\"addon-number-input\"\n            required={addon.required}\n          />\n        );\n        \n      case 'email':\n        return (\n          <input\n            type=\"email\"\n            value={value}\n            onChange={(e) => handleAddonChange(fieldId, e.target.value)}\n            placeholder={addon.placeholder || 'email@ejemplo.com'}\n            className=\"addon-email-input\"\n            required={addon.required}\n          />\n        );\n        \n      case 'select':\n      case 'dropdown':\n        return (\n          <select\n            value={value}\n            onChange={(e) => handleAddonChange(fieldId, e.target.value)}\n            className=\"addon-select\"\n            required={addon.required}\n          >\n            <option value=\"\">Selecciona una opción</option>\n            {addon.options?.map((option, index) => (\n              <option key={index} value={option.label || option.value}>\n                {option.label || option.value}\n                {option.price && option.price > 0 && ` (+${formatPrice(option.price)})`}\n              </option>\n            ))}\n          </select>\n        );\n        \n      case 'radio':\n      case 'radiobutton':\n        return (\n          <div className=\"addon-radio-group\">\n            {addon.options?.map((option, index) => (\n              <label key={index} className=\"addon-radio-option\">\n                <input\n                  type=\"radio\"\n                  name={fieldId}\n                  value={option.label || option.value}\n                  checked={value === (option.label || option.value)}\n                  onChange={(e) => handleAddonChange(fieldId, e.target.value)}\n                  required={addon.required}\n                />\n                <span className=\"radio-label\">\n                  {option.label || option.value}\n                  {option.price && option.price > 0 && ` (+${formatPrice(option.price)})`}\n                </span>\n              </label>\n            ))}\n          </div>\n        );\n        \n      case 'checkbox':\n      case 'multiple_choice':\n        return (\n          <div className=\"addon-checkbox-group\">\n            {addon.options?.map((option, index) => (\n              <label key={index} className=\"addon-checkbox-option\">\n                <input\n                  type=\"checkbox\"\n                  value={option.label || option.value}\n                  checked={Array.isArray(value) && value.includes(option.label || option.value)}\n                  onChange={(e) => {\n                    const optionValue = option.label || option.value;\n                    const currentValues = Array.isArray(value) ? value : [];\n                    \n                    if (e.target.checked) {\n                      handleAddonChange(fieldId, [...currentValues, optionValue]);\n                    } else {\n                      handleAddonChange(fieldId, currentValues.filter(v => v !== optionValue));\n                    }\n                  }}\n                />\n                <span className=\"checkbox-label\">\n                  {option.label || option.value}\n                  {option.price && option.price > 0 && ` (+${formatPrice(option.price)})`}\n                </span>\n              </label>\n            ))}\n          </div>\n        );\n        \n      case 'file':\n      case 'file_upload':\n        return (\n          <div className=\"addon-file-upload\">\n            <label className=\"file-upload-label\">\n              <input\n                type=\"file\"\n                onChange={(e) => handleFileUpload(fieldId, e.target.files[0])}\n                accept={addon.allowed_types || '*'}\n                required={addon.required}\n                className=\"file-input\"\n              />\n              <span className=\"file-upload-button\">\n                <Upload size={16} />\n                {addonFiles[fieldId] ? addonFiles[fieldId].name : 'Seleccionar archivo'}\n              </span>\n            </label>\n            {addon.max_size && (\n              <p className=\"file-size-info\">Tamaño máximo: {addon.max_size}MB</p>\n            )}\n          </div>\n        );\n        \n      case 'date':\n      case 'date_picker':\n        return (\n          <input\n            type=\"date\"\n            value={value}\n            onChange={(e) => handleAddonChange(fieldId, e.target.value)}\n            min={addon.min_date || undefined}\n            max={addon.max_date || undefined}\n            className=\"addon-date-input\"\n            required={addon.required}\n          />\n        );\n        \n      case 'color':\n      case 'color_picker':\n        return (\n          <input\n            type=\"color\"\n            value={value || '#000000'}\n            onChange={(e) => handleAddonChange(fieldId, e.target.value)}\n            className=\"addon-color-input\"\n            required={addon.required}\n          />\n        );\n        \n      case 'true_false':\n        return (\n          <label className=\"addon-checkbox-option\">\n            <input\n              type=\"checkbox\"\n              checked={value === true || value === 'yes'}\n              onChange={(e) => handleAddonChange(fieldId, e.target.checked)}\n              required={addon.required}\n            />\n            <span className=\"checkbox-label\">\n              {addon.label || 'Sí'}\n            </span>\n          </label>\n        );\n        \n      default:\n        return null;\n    }\n  };\n\n  if (!isOpen || !product) return null;\n\n  return (\n    <div className=\"customization-modal-overlay\" onClick={onClose}>\n      <div className=\"customization-modal\" onClick={(e) => e.stopPropagation()}>\n        <button className=\"close-button\" onClick={onClose}>\n          <X size={24} />\n        </button>\n\n        <h2>Personaliza tu {product.name}</h2>\n\n        {loading ? (\n          <div className=\"loading-container\">\n            <Loader className=\"loading-spinner\" size={48} />\n            <p>Cargando opciones...</p>\n          </div>\n        ) : error ? (\n          <div className=\"error-container\">\n            <p className=\"error-message\">{error}</p>\n            <button onClick={loadProductData} className=\"retry-button\">\n              Reintentar\n            </button>\n          </div>\n        ) : (\n          <>\n            {/* Información del producto */}\n            <div className=\"customization-product-info\">\n              {product.images && product.images[0] ? (\n                <img \n                  src={product.images[0].src} \n                  alt={product.name} \n                  className=\"customization-product-image\"\n                />\n              ) : (\n                <div className=\"customization-product-image placeholder\">\n                  <Pizza size={48} />\n                </div>\n              )}\n              <div className=\"product-details\">\n                <h3>{product.name}</h3>\n                {product.short_description && (\n                  <p className=\"product-description\" \n                     dangerouslySetInnerHTML={{ __html: product.short_description }} />\n                )}\n              </div>\n            </div>\n\n            {/* Atributos de variación */}\n            {attributes.length > 0 && (\n              <div className=\"customization-section\">\n                {attributes.map(attribute => (\n                  <div key={attribute.id || attribute.name} className=\"attribute-section\">\n                    <h4>{attribute.name}</h4>\n                    {attribute.description && (\n                      <p className=\"section-description\">{attribute.description}</p>\n                    )}\n                    <div className=\"attribute-options\">\n                      {attribute.options.map(option => (\n                        <label key={option} className=\"attribute-option\">\n                          <input\n                            type=\"radio\"\n                            name={attribute.name}\n                            value={option}\n                            checked={selectedAttributes[attribute.name] === option}\n                            onChange={() => handleAttributeChange(attribute.name, option)}\n                          />\n                          <span className=\"option-label\">\n                            <span className=\"option-check\">\n                              <Check size={16} />\n                            </span>\n                            {option}\n                          </span>\n                        </label>\n                      ))}\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n\n            {/* Advanced Product Fields */}\n            {productAddons.length > 0 && (\n              <div className=\"customization-section\">\n                <h4>Opciones adicionales</h4>\n                {productAddons.map((addon, index) => (\n                  <div key={addon.id || addon.name || index} className=\"addon-field\">\n                    <label className=\"addon-label\">\n                      {addon.title || addon.name}\n                      {addon.required && <span className=\"required\">*</span>}\n                      {addon.price && addon.price > 0 && (\n                        <span className=\"addon-price\">\n                          {addon.price_type === 'quantity_based' \n                            ? ` (+${formatPrice(addon.price)} por unidad)`\n                            : ` (+${formatPrice(addon.price)})`\n                          }\n                        </span>\n                      )}\n                    </label>\n                    {addon.description && (\n                      <p className=\"addon-description\">{addon.description}</p>\n                    )}\n                    {renderAddonField(addon)}\n                  </div>\n                ))}\n              </div>\n            )}\n\n            {/* Mostrar información de la variación seleccionada */}\n            {selectedVariation && (selectedVariation.stock_status === 'outofstock' || \n              (selectedVariation.stock_quantity && selectedVariation.stock_quantity < 10)) && (\n              <div className=\"variation-info\">\n                <div className=\"variation-details\">\n                  {selectedVariation.stock_status === 'outofstock' ? (\n                    <p className=\"out-of-stock\">⚠️ Producto agotado</p>\n                  ) : selectedVariation.stock_quantity && selectedVariation.stock_quantity < 10 ? (\n                    <p className=\"low-stock\">⚡ Últimas {selectedVariation.stock_quantity} unidades</p>\n                  ) : null}\n                </div>\n              </div>\n            )}\n\n            {/* Instrucciones especiales */}\n            <div className=\"customization-section\">\n              <h4>Instrucciones especiales (opcional)</h4>\n              <p className=\"section-description\">\n                ¿Alguna preferencia especial?\n              </p>\n              <textarea\n                className=\"special-instructions\"\n                value={specialInstructions}\n                onChange={(e) => setSpecialInstructions(e.target.value)}\n                placeholder=\"Ej: Sin cebolla, extra queso, etc.\"\n                maxLength={200}\n              />\n              <span className=\"char-count\">\n                {specialInstructions.length}/200\n              </span>\n            </div>\n\n            {/* Controles de cantidad y precio */}\n            <div className=\"customization-section quantity-controls\">\n              <div className=\"quantity-selector\">\n                <button \n                  className=\"quantity-btn\"\n                  onClick={() => setQuantity(Math.max(1, quantity - 1))}\n                  disabled={quantity <= 1}\n                >\n                  <Minus size={16} />\n                </button>\n                <span className=\"quantity-value\">{quantity}</span>\n                <button \n                  className=\"quantity-btn\"\n                  onClick={() => setQuantity(quantity + 1)}\n                  disabled={selectedVariation && selectedVariation.stock_quantity && \n                           quantity >= selectedVariation.stock_quantity}\n                >\n                  <Plus size={16} />\n                </button>\n              </div>\n              <div className=\"quantity-price\">\n                <span className=\"price-label\">Precio unitario</span>\n                <span className=\"price-value\">{formatPrice(totalPrice / quantity)}</span>\n              </div>\n            </div>\n          </>\n        )}\n\n        {/* Footer con precio total y botón de agregar */}\n        <div className=\"customization-footer\">\n          <div className=\"total-info\">\n            <span className=\"total-label\">Total</span>\n            <span className=\"total-price\">{formatPrice(totalPrice)}</span>\n          </div>\n          <button \n            className={`add-to-cart-btn ${addingToCart ? 'adding' : ''}`}\n            onClick={handleAddToCart}\n            disabled={loading || addingToCart || \n                     (selectedVariation && selectedVariation.stock_status === 'outofstock')}\n          >\n            {addingToCart ? (\n              <>\n                <Loader className=\"btn-spinner\" size={20} />\n                <span>Agregando...</span>\n              </>\n            ) : (\n              <>\n                <Check className=\"btn-icon\" size={20} />\n                <span>Agregar al carrito</span>\n              </>\n            )}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default CustomizationModal;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}