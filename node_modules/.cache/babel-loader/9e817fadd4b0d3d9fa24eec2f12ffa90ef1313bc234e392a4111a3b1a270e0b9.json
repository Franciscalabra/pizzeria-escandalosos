{"ast":null,"code":"// src/services/woocommerceApi.js\nimport{getApiUrl,getAuthHeaders}from'../config/woocommerce';class WooCommerceAPI{// Método genérico para hacer peticiones\nasync request(endpoint){let method=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'GET';let data=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;try{const url=getApiUrl(endpoint);const options={method,headers:getAuthHeaders()};if(data&&method!=='GET'){options.body=JSON.stringify(data);}console.log('Request URL:',url);console.log('Request options:',options);const response=await fetch(url,options);// Intentar obtener el cuerpo de la respuesta\nconst responseText=await response.text();let responseData;try{responseData=JSON.parse(responseText);}catch(e){responseData=responseText;}if(!response.ok){console.error('Error response:',responseData);throw new Error(`Error ${response.status}: ${responseData.message||responseData.code||response.statusText}`);}return responseData;}catch(error){console.error('Error en la petición a WooCommerce:',error);throw error;}}// === PRODUCTOS ===\n// Obtener todos los productos\nasync getProducts(){let params=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};const queryParams=new URLSearchParams({per_page:100,...params}).toString();return this.request(`products?${queryParams}`);}// Obtener un producto por ID\nasync getProduct(id){return this.request(`products/${id}`);}// Obtener categorías de productos\nasync getCategories(){return this.request('products/categories?per_page=100');}// === PEDIDOS ===\n// Crear un nuevo pedido\nasync createOrder(orderData){const order={payment_method:orderData.paymentMethod||'cash',payment_method_title:orderData.paymentMethodTitle||'Pago en efectivo',set_paid:false,status:'pending',billing:{first_name:orderData.customerName,last_name:'',address_1:orderData.address||'',city:orderData.city||'Santiago',state:'',postcode:'',country:'CL',email:orderData.email||'',phone:orderData.phone||''},shipping:{first_name:orderData.customerName,last_name:'',address_1:orderData.address||'',city:orderData.city||'Santiago',state:'',postcode:'',country:'CL'},line_items:orderData.items.map(item=>({product_id:parseInt(item.productId),// Asegurarse de que sea un número\nquantity:parseInt(item.quantity)})),shipping_lines:orderData.shipping?[{method_id:'flat_rate',method_title:'Delivery',total:orderData.shipping.toString()}]:[],customer_note:orderData.notes||''};console.log('Order payload:',JSON.stringify(order,null,2));return this.request('orders','POST',order);}// Obtener pedidos\nasync getOrders(){let params=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};const queryParams=new URLSearchParams({per_page:20,...params}).toString();return this.request(`orders?${queryParams}`);}// Obtener un pedido por ID\nasync getOrder(id){return this.request(`orders/${id}`);}// Actualizar estado del pedido\nasync updateOrderStatus(orderId,status){return this.request(`orders/${orderId}`,'PUT',{status});}// === CLIENTES ===\n// Crear cliente\nasync createCustomer(customerData){const customer={email:customerData.email,first_name:customerData.firstName,last_name:customerData.lastName||'',username:customerData.email,billing:{first_name:customerData.firstName,last_name:customerData.lastName||'',email:customerData.email,phone:customerData.phone||'',address_1:customerData.address||'',city:customerData.city||'Santiago',country:'CL'}};return this.request('customers','POST',customer);}// Buscar cliente por email\nasync getCustomerByEmail(email){return this.request(`customers?email=${email}`);}// === MÉTODOS DE PAGO ===\n// Obtener métodos de pago disponibles\nasync getPaymentMethods(){return this.request('payment_gateways');}// === ZONAS DE ENVÍO ===\n// Obtener zonas de envío\nasync getShippingZones(){return this.request('shipping/zones');}// === CUPONES ===\n// Validar cupón\nasync getCoupon(code){return this.request(`coupons?code=${code}`);}}// Exportar instancia única\nexport default new WooCommerceAPI();","map":{"version":3,"names":["getApiUrl","getAuthHeaders","WooCommerceAPI","request","endpoint","method","arguments","length","undefined","data","url","options","headers","body","JSON","stringify","console","log","response","fetch","responseText","text","responseData","parse","e","ok","error","Error","status","message","code","statusText","getProducts","params","queryParams","URLSearchParams","per_page","toString","getProduct","id","getCategories","createOrder","orderData","order","payment_method","paymentMethod","payment_method_title","paymentMethodTitle","set_paid","billing","first_name","customerName","last_name","address_1","address","city","state","postcode","country","email","phone","shipping","line_items","items","map","item","product_id","parseInt","productId","quantity","shipping_lines","method_id","method_title","total","customer_note","notes","getOrders","getOrder","updateOrderStatus","orderId","createCustomer","customerData","customer","firstName","lastName","username","getCustomerByEmail","getPaymentMethods","getShippingZones","getCoupon"],"sources":["/Users/franciscalabra/Desktop/pizzeria-escandalosos/src/services/woocommerceApi.js"],"sourcesContent":["// src/services/woocommerceApi.js\nimport { getApiUrl, getAuthHeaders } from '../config/woocommerce';\n\nclass WooCommerceAPI {\n  // Método genérico para hacer peticiones\n  async request(endpoint, method = 'GET', data = null) {\n    try {\n      const url = getApiUrl(endpoint);\n      const options = {\n        method,\n        headers: getAuthHeaders(),\n      };\n\n      if (data && method !== 'GET') {\n        options.body = JSON.stringify(data);\n      }\n\n      console.log('Request URL:', url);\n      console.log('Request options:', options);\n\n      const response = await fetch(url, options);\n      \n      // Intentar obtener el cuerpo de la respuesta\n      const responseText = await response.text();\n      let responseData;\n      \n      try {\n        responseData = JSON.parse(responseText);\n      } catch (e) {\n        responseData = responseText;\n      }\n\n      if (!response.ok) {\n        console.error('Error response:', responseData);\n        throw new Error(`Error ${response.status}: ${responseData.message || responseData.code || response.statusText}`);\n      }\n\n      return responseData;\n    } catch (error) {\n      console.error('Error en la petición a WooCommerce:', error);\n      throw error;\n    }\n  }\n\n  // === PRODUCTOS ===\n  \n  // Obtener todos los productos\n  async getProducts(params = {}) {\n    const queryParams = new URLSearchParams({\n      per_page: 100,\n      ...params\n    }).toString();\n    \n    return this.request(`products?${queryParams}`);\n  }\n\n  // Obtener un producto por ID\n  async getProduct(id) {\n    return this.request(`products/${id}`);\n  }\n\n  // Obtener categorías de productos\n  async getCategories() {\n    return this.request('products/categories?per_page=100');\n  }\n\n  // === PEDIDOS ===\n  \n  // Crear un nuevo pedido\n  async createOrder(orderData) {\n    const order = {\n      payment_method: orderData.paymentMethod || 'cash',\n      payment_method_title: orderData.paymentMethodTitle || 'Pago en efectivo',\n      set_paid: false,\n      status: 'pending',\n      billing: {\n        first_name: orderData.customerName,\n        last_name: '',\n        address_1: orderData.address || '',\n        city: orderData.city || 'Santiago',\n        state: '',\n        postcode: '',\n        country: 'CL',\n        email: orderData.email || '',\n        phone: orderData.phone || ''\n      },\n      shipping: {\n        first_name: orderData.customerName,\n        last_name: '',\n        address_1: orderData.address || '',\n        city: orderData.city || 'Santiago',\n        state: '',\n        postcode: '',\n        country: 'CL'\n      },\n      line_items: orderData.items.map(item => ({\n        product_id: parseInt(item.productId), // Asegurarse de que sea un número\n        quantity: parseInt(item.quantity)\n      })),\n      shipping_lines: orderData.shipping ? [{\n        method_id: 'flat_rate',\n        method_title: 'Delivery',\n        total: orderData.shipping.toString()\n      }] : [],\n      customer_note: orderData.notes || ''\n    };\n\n    console.log('Order payload:', JSON.stringify(order, null, 2));\n\n    return this.request('orders', 'POST', order);\n  }\n\n  // Obtener pedidos\n  async getOrders(params = {}) {\n    const queryParams = new URLSearchParams({\n      per_page: 20,\n      ...params\n    }).toString();\n    \n    return this.request(`orders?${queryParams}`);\n  }\n\n  // Obtener un pedido por ID\n  async getOrder(id) {\n    return this.request(`orders/${id}`);\n  }\n\n  // Actualizar estado del pedido\n  async updateOrderStatus(orderId, status) {\n    return this.request(`orders/${orderId}`, 'PUT', { status });\n  }\n\n  // === CLIENTES ===\n  \n  // Crear cliente\n  async createCustomer(customerData) {\n    const customer = {\n      email: customerData.email,\n      first_name: customerData.firstName,\n      last_name: customerData.lastName || '',\n      username: customerData.email,\n      billing: {\n        first_name: customerData.firstName,\n        last_name: customerData.lastName || '',\n        email: customerData.email,\n        phone: customerData.phone || '',\n        address_1: customerData.address || '',\n        city: customerData.city || 'Santiago',\n        country: 'CL'\n      }\n    };\n\n    return this.request('customers', 'POST', customer);\n  }\n\n  // Buscar cliente por email\n  async getCustomerByEmail(email) {\n    return this.request(`customers?email=${email}`);\n  }\n\n  // === MÉTODOS DE PAGO ===\n  \n  // Obtener métodos de pago disponibles\n  async getPaymentMethods() {\n    return this.request('payment_gateways');\n  }\n\n  // === ZONAS DE ENVÍO ===\n  \n  // Obtener zonas de envío\n  async getShippingZones() {\n    return this.request('shipping/zones');\n  }\n\n  // === CUPONES ===\n  \n  // Validar cupón\n  async getCoupon(code) {\n    return this.request(`coupons?code=${code}`);\n  }\n}\n\n// Exportar instancia única\nexport default new WooCommerceAPI();"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}